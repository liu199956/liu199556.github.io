<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"manual","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="MySQL初始sql12345# SQL语言主要用于存取数据、查询数据、更新数据和管理关系数据库系统,SQL语言由IBM开发。SQL语言分为3种类型：#1、DDL语句    数据库定义语言： 数据库、表、视图、索引、存储过程，例如CREATE DROP ALTER#2、DML语句    数据库操纵语言： 插入数据INSERT、删除数据DELETE、更新数据UPDATE、查询数据SELECT#3、D">
<meta property="og:type" content="article">
<meta property="og:title" content="Mysql">
<meta property="og:url" content="http://example.com/2020/08/20/MySQL/index.html">
<meta property="og:site_name" content="Admin">
<meta property="og:description" content="MySQL初始sql12345# SQL语言主要用于存取数据、查询数据、更新数据和管理关系数据库系统,SQL语言由IBM开发。SQL语言分为3种类型：#1、DDL语句    数据库定义语言： 数据库、表、视图、索引、存储过程，例如CREATE DROP ALTER#2、DML语句    数据库操纵语言： 插入数据INSERT、删除数据DELETE、更新数据UPDATE、查询数据SELECT#3、D">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2020/08/20/MySQL/image-20210307060739486.png">
<meta property="article:published_time" content="2020-08-20T09:23:37.000Z">
<meta property="article:modified_time" content="2022-06-15T16:13:24.219Z">
<meta property="article:author" content="Admin">
<meta property="article:tag" content="Mysql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2020/08/20/MySQL/image-20210307060739486.png">

<link rel="canonical" href="http://example.com/2020/08/20/MySQL/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Mysql | Admin</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Admin" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
	
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Admin</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/08/20/MySQL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Admin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Admin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Mysql
        </h1>

        <div class="post-meta">
		<!-- 设置置顶标志 -->
			
			  <i class="fa fa-thumb-tack"></i>
			  <font color=7D26CD>置顶</font>
			  <span class="post-meta-divider">|</span>
			
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-08-20 17:23:37" itemprop="dateCreated datePublished" datetime="2020-08-20T17:23:37+08:00">2020-08-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-16 00:13:24" itemprop="dateModified" datetime="2022-06-16T00:13:24+08:00">2022-06-16</time>
              </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h1><h3 id="初始sql"><a href="#初始sql" class="headerlink" title="初始sql"></a>初始sql</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SQL语言主要用于存取数据、查询数据、更新数据和管理关系数据库系统,SQL语言由IBM开发。SQL语言分为3种类型：</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1、DDL语句    数据库定义语言： 数据库、表、视图、索引、存储过程，例如CREATE DROP ALTER</span></span><br><span class="line"><span class="comment">#2、DML语句    数据库操纵语言： 插入数据INSERT、删除数据DELETE、更新数据UPDATE、查询数据SELECT</span></span><br><span class="line"><span class="comment">#3、DCL语句    数据库控制语言： 例如控制用户的访问权限GRANT、REVOKE</span></span><br></pre></td></tr></table></figure>



<h3 id="针对库的修删改查-文件夹"><a href="#针对库的修删改查-文件夹" class="headerlink" title="针对库的修删改查(文件夹)"></a>针对库的修删改查(文件夹)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#增 create database db charset = &#x27;gbk(可以指定编码)&#x27;;</span></span><br><span class="line"><span class="comment">#查看所有 show databases db;</span></span><br><span class="line"><span class="comment">#查看单个 show create database db;</span></span><br><span class="line"><span class="comment">#改 alter database db charset = &#x27;utf-8&#x27;</span></span><br><span class="line"><span class="comment">#删 drop databases db;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="针对表的修删改查（文件）"><a href="#针对表的修删改查（文件）" class="headerlink" title="针对表的修删改查（文件）"></a>针对表的修删改查（文件）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">在操作表（文件）的时候，需要指定所在的库（文件夹）</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 查看当前所在库的名字</span></span><br><span class="line">select database();</span><br><span class="line"><span class="comment"># 切换库</span></span><br><span class="line">use db; <span class="comment">#切换到db库下就会在当前这个库下面操作</span></span><br><span class="line"><span class="comment"># 增</span></span><br><span class="line"><span class="comment"># 创建一个表有id name字段 char（4）4限制字符个数</span></span><br><span class="line">create table t1(<span class="built_in">id</span> <span class="built_in">int</span>,name char);</span><br><span class="line"><span class="comment"># 增加字段</span></span><br><span class="line">alter table t1 add gender char(<span class="number">4</span>)first;</span><br><span class="line">alter table t1 add level <span class="built_in">int</span> after <span class="built_in">id</span></span><br><span class="line"><span class="comment"># 查 </span></span><br><span class="line">show tables; <span class="comment"># 查看当前库下所有表名</span></span><br><span class="line">show create table t1; <span class="comment">#查看创建的表名</span></span><br><span class="line">describe t1; <span class="comment">#描述详细的表，简写为 desc t1;</span></span><br><span class="line"><span class="comment"># 改</span></span><br><span class="line">alter table t1 modify name char(<span class="number">8</span>); <span class="comment">#修改name字段的字符个数</span></span><br><span class="line"><span class="comment"># 修改字段</span></span><br><span class="line">alter table t1 change name mingzi char(<span class="number">3</span>); <span class="comment">#修改name字段改为mingzi字符长度（3）位</span></span><br><span class="line">alter table t1 change name NAME char(<span class="number">4</span>),change <span class="built_in">id</span> ID tinyint;</span><br><span class="line"><span class="comment"># 删</span></span><br><span class="line">drop table t1;</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">create table db1.t1(id int); 也可以用绝对路径操作不同的库</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="针对数据的修删改查"><a href="#针对数据的修删改查" class="headerlink" title="针对数据的修删改查"></a>针对数据的修删改查</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">一定要先有库再有表才能操作记录</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 增</span></span><br><span class="line">insert into m1 values(<span class="number">1</span>,<span class="string">&#x27;alex&#x27;</span>);</span><br><span class="line"><span class="comment"># 逗号隔开支持多个</span></span><br><span class="line">insert into m1 values(<span class="number">1</span>,<span class="string">&#x27;alex&#x27;</span>),(<span class="number">2</span>,<span class="string">&#x27;egon&#x27;</span>),(<span class="number">3</span>,<span class="string">&#x27;lxx&#x27;</span>);</span><br><span class="line"><span class="comment"># 查</span></span><br><span class="line">select * <span class="keyword">from</span> m1; <span class="comment">#查所有，当数据量特别大不推荐使用</span></span><br><span class="line">select name <span class="keyword">from</span> m1;</span><br><span class="line"><span class="comment"># 改</span></span><br><span class="line">update m1 <span class="built_in">set</span> name=<span class="string">&#x27;dsb&#x27;</span> where <span class="built_in">id</span>&gt;<span class="number">1</span>;</span><br><span class="line"><span class="comment"># 删</span></span><br><span class="line">delete <span class="keyword">from</span> m1 where <span class="built_in">id</span> &gt;<span class="number">1</span>;</span><br><span class="line">delete <span class="keyword">from</span> m1 where name = <span class="string">&#x27;alex&#x27;</span>;</span><br><span class="line"><span class="comment"># 将表所有的数据清空</span></span><br><span class="line">delete <span class="keyword">from</span> m1;</span><br><span class="line"><span class="comment"># 清空整张表：</span></span><br><span class="line">    truncate m1;</span><br><span class="line">     auto_increment 表示：自增</span><br><span class="line">     primary key 表示：约束（不能重复且不能为空）；加速查找</span><br><span class="line">    create table t3(<span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,name char(<span class="number">10</span>));</span><br><span class="line">    insert t3(name) values(<span class="string">&quot;egon&quot;</span>),(<span class="string">&quot;tom&quot;</span>),(<span class="string">&quot;jack&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="Mysql主要存储引擎"><a href="#Mysql主要存储引擎" class="headerlink" title="Mysql主要存储引擎"></a>Mysql主要存储引擎</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">innodb 存储数据更加安全</span><br><span class="line">myisam 比innodb速度快，但更注重的事数据安全</span><br><span class="line">memory 内存引擎（数据全部存放在内存中）断电数据丢失</span><br><span class="line">blackhole 无论存什么，都立刻消失(黑洞)</span><br><span class="line"></span><br><span class="line">MariaDB [db1]&gt; create table t1(<span class="built_in">id</span> <span class="built_in">int</span>)engine=innodb;</span><br><span class="line">MariaDB [db1]&gt; create table t2(<span class="built_in">id</span> <span class="built_in">int</span>)engine=myisam;</span><br><span class="line">MariaDB [db1]&gt; create table t3(<span class="built_in">id</span> <span class="built_in">int</span>)engine=memory;</span><br><span class="line">MariaDB [db1]&gt; create table t4(<span class="built_in">id</span> <span class="built_in">int</span>)engine=blackhole;</span><br><span class="line">MariaDB [db1]&gt; quit</span><br><span class="line">[root@egon db1]<span class="comment"># ls /var/lib/mysql/db1/ #发现后两种存储引擎只有表结构，无数据</span></span><br><span class="line">db.opt  t1.frm  t1.ibd  t2.MYD  t2.MYI  t2.frm  t3.frm  t4.frm</span><br><span class="line"></span><br><span class="line"><span class="comment">#memory，在重启mysql或者重启机器后，表内数据清空</span></span><br><span class="line"><span class="comment">#blackhole，往表内插入任何数据，都相当于丢入黑洞，表内永远不存记录</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="创建表的完整语法"><a href="#创建表的完整语法" class="headerlink" title="创建表的完整语法"></a>创建表的完整语法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#语法：</span></span><br><span class="line">create table 表名(</span><br><span class="line">字段名<span class="number">1</span> 类型[(宽度) 约束条件],</span><br><span class="line">字段名<span class="number">2</span> 类型[(宽度) 约束条件],</span><br><span class="line">字段名<span class="number">3</span> 类型[(宽度) 约束条件]</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#注意：</span></span><br><span class="line"><span class="number">1.</span> 在同一张表中，字段名是不能相同</span><br><span class="line"><span class="number">2.</span> 宽度和约束条件可选</span><br><span class="line"><span class="number">3.</span> 字段名和类型是必须的</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> create database db;</span><br><span class="line"><span class="number">2</span> use db;</span><br><span class="line">  select database(); </span><br><span class="line"><span class="comment"># 表中的最后一个字段不要加逗号</span></span><br><span class="line"><span class="number">3</span> create table t1 (<span class="built_in">id</span> <span class="built_in">int</span>,</span><br><span class="line">             name char(<span class="number">5</span>),</span><br><span class="line">             age <span class="built_in">int</span>(<span class="number">3</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">4</span> insert into t1 values(<span class="number">1</span>,<span class="string">&#x27;alex&#x27;</span>,<span class="number">18</span>);</span><br><span class="line">  insert into t1 values(<span class="number">2</span>,<span class="string">&#x27;egon&#x27;</span>,<span class="number">28</span>);</span><br><span class="line">  insert into t1 values(<span class="number">3</span>,<span class="string">&#x27;tank&#x27;</span>,<span class="number">38</span>);</span><br><span class="line"></span><br><span class="line">  insert into t1 values(<span class="number">1</span>,<span class="string">&#x27;alex&#x27;</span>,<span class="number">18</span>),(<span class="number">2</span>,<span class="string">&#x27;egon&#x27;</span>,<span class="number">28</span>),(<span class="number">3</span>,<span class="string">&#x27;tank&#x27;</span>,<span class="number">38</span>);</span><br><span class="line"></span><br><span class="line"><span class="number">5</span> insert into t1(<span class="built_in">id</span>) values(<span class="number">5</span>),(<span class="number">6</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="修改表"><a href="#修改表" class="headerlink" title="修改表"></a>修改表</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">create table tt1(<span class="built_in">id</span> <span class="built_in">int</span>, name char(<span class="number">4</span>));</span><br><span class="line"><span class="comment"># 修改表名</span></span><br><span class="line">alter table tt1 rename t1;</span><br><span class="line"><span class="comment"># 修改字段</span></span><br><span class="line">alter table t1 modify <span class="built_in">id</span> tinyint;</span><br><span class="line"></span><br><span class="line">alter table t1 change name NAME char(<span class="number">4</span>),change <span class="built_in">id</span> ID tinyint;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 增加字段</span></span><br><span class="line">alter table t1 add sex char(<span class="number">4</span>)after ID,add level <span class="built_in">int</span> first;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除字段</span></span><br><span class="line">alter table t1 drop sex;</span><br><span class="line">alter table t1 drop NAME,drop gender;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制表</span></span><br><span class="line">create table tt1 select user, password,host <span class="keyword">from</span> mysql.user;</span><br><span class="line"></span><br><span class="line">desc tt1;</span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> tt1;</span><br><span class="line">+------+-------------------------------------------+-----------+</span><br><span class="line">| user | password                                  | host      |</span><br><span class="line">+------+-------------------------------------------+-----------+</span><br><span class="line">| root | *4363FCCB4E301C8C07D323BFEEBC53BF1B8F3517 | localhost |</span><br><span class="line">| root |                                           | <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> |</span><br><span class="line">| root |                                           | ::<span class="number">1</span>       |</span><br><span class="line">|      |                                           | localhost |</span><br><span class="line">+------+-------------------------------------------+-----------+</span><br><span class="line"><span class="comment"># 只复制表结构</span></span><br><span class="line">create table t3 select user,host,password <span class="keyword">from</span> mysql.user where <span class="number">1</span>!=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> tt1;</span><br><span class="line">Empty <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">示例：</span><br><span class="line"><span class="number">1.</span> 修改存储引擎</span><br><span class="line">mysql&gt; alter table service </span><br><span class="line">    -&gt; engine=innodb;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> 添加字段</span><br><span class="line">mysql&gt; alter table student10</span><br><span class="line">    -&gt; add name varchar(<span class="number">20</span>) <span class="keyword">not</span> null,</span><br><span class="line">    -&gt; add age <span class="built_in">int</span>(<span class="number">3</span>) <span class="keyword">not</span> null default <span class="number">22</span>;</span><br><span class="line">    </span><br><span class="line">mysql&gt; alter table student10</span><br><span class="line">    -&gt; add stu_num varchar(<span class="number">10</span>) <span class="keyword">not</span> null after name;                //添加name字段之后</span><br><span class="line"></span><br><span class="line">mysql&gt; alter table student10                        </span><br><span class="line">    -&gt; add sex enum(<span class="string">&#x27;male&#x27;</span>,<span class="string">&#x27;female&#x27;</span>) default <span class="string">&#x27;male&#x27;</span> first;          //添加到最前面</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 删除字段</span><br><span class="line">mysql&gt; alter table student10</span><br><span class="line">    -&gt; drop sex;</span><br><span class="line"></span><br><span class="line">mysql&gt; alter table service</span><br><span class="line">    -&gt; drop mac;</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> 修改字段类型modify</span><br><span class="line">mysql&gt; alter table student10</span><br><span class="line">    -&gt; modify age <span class="built_in">int</span>(<span class="number">3</span>);</span><br><span class="line">mysql&gt; alter table student10</span><br><span class="line">    -&gt; modify <span class="built_in">id</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">not</span> null primary key auto_increment;    //修改为主键</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span> 增加约束（针对已有的主键增加auto_increment）</span><br><span class="line">mysql&gt; alter table student10 modify <span class="built_in">id</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">not</span> null primary key auto_increment;</span><br><span class="line">ERROR <span class="number">1068</span> (<span class="number">42000</span>): Multiple primary key defined</span><br><span class="line"></span><br><span class="line">mysql&gt; alter table student10 modify <span class="built_in">id</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">not</span> null auto_increment;</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.01</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="number">6.</span> 对已经存在的表增加复合主键</span><br><span class="line">mysql&gt; alter table service2</span><br><span class="line">    -&gt; add primary key(host_ip,port);        </span><br><span class="line"></span><br><span class="line"><span class="number">7.</span> 增加主键</span><br><span class="line">mysql&gt; alter table student1</span><br><span class="line">    -&gt; modify name varchar(<span class="number">10</span>) <span class="keyword">not</span> null primary key;</span><br><span class="line"></span><br><span class="line"><span class="number">8.</span> 增加主键和自动增长</span><br><span class="line">mysql&gt; alter table student1</span><br><span class="line">    -&gt; modify <span class="built_in">id</span> <span class="built_in">int</span> <span class="keyword">not</span> null primary key auto_increment;</span><br><span class="line"></span><br><span class="line"><span class="number">9.</span> 删除主键</span><br><span class="line">a. 删除自增约束</span><br><span class="line">mysql&gt; alter table student10 modify <span class="built_in">id</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">not</span> null; </span><br><span class="line"></span><br><span class="line">b. 删除主键</span><br><span class="line">mysql&gt; alter table student10                                 </span><br><span class="line">    -&gt; drop primary key;</span><br></pre></td></tr></table></figure>



<h1 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h1><h3 id="表字段类型之整型"><a href="#表字段类型之整型" class="headerlink" title="表字段类型之整型"></a>表字段类型之整型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">create table t6(<span class="built_in">id</span> <span class="built_in">int</span>);</span><br><span class="line">create table t7(<span class="built_in">id</span> tinyint);</span><br><span class="line">insert into t6 values(<span class="number">112</span>)；</span><br><span class="line">insert into t6 values(<span class="number">11233333333</span>);</span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> t6;</span><br><span class="line">+------------+</span><br><span class="line">| <span class="built_in">id</span>         |</span><br><span class="line">+------------+</span><br><span class="line">|        <span class="number">112</span> |</span><br><span class="line">| <span class="number">2147483647</span> |</span><br><span class="line">+------------+</span><br><span class="line"></span><br><span class="line">insert into t7 values(<span class="number">128</span>);</span><br><span class="line">insert into t7 values(<span class="number">129</span>);</span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> t7;</span><br><span class="line">+------+</span><br><span class="line">| <span class="built_in">id</span>   |</span><br><span class="line">+------+</span><br><span class="line">|  <span class="number">127</span> |</span><br><span class="line">|  <span class="number">127</span> |</span><br><span class="line">+------+</span><br><span class="line"><span class="number">2</span> rows <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 浮点型</span></span><br><span class="line">m是数字总个数，d是小数点后个数。</span><br><span class="line">create table t8</span><br><span class="line">	(x <span class="built_in">float</span>(<span class="number">255</span>,<span class="number">30</span>),  <span class="comment">#随着小数的增多，精度开始不准确</span></span><br><span class="line"> 	y double(<span class="number">255</span>,<span class="number">30</span>),  <span class="comment">#精度比float要准确点，但随着小数的增多，同样变得不准确</span></span><br><span class="line"> 	z decimal(<span class="number">65</span>,<span class="number">30</span>)); <span class="comment">#精度始终准确,d为30，于是只留了30位小数</span></span><br><span class="line"></span><br><span class="line">insert into t8 values</span><br><span class="line">(<span class="number">1.111111111111111111111111111111</span>,<span class="number">1.111111111111111111111111111111</span>,<span class="number">1.111111111111111111111111111111</span>);</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> t8;</span><br><span class="line">+----------------------------------+----------------------------------+----------------------------------+</span><br><span class="line">| x                                | y                                | z                                |</span><br><span class="line">+----------------------------------+----------------------------------+----------------------------------+</span><br><span class="line">| <span class="number">1.111111164093017600000000000000</span> | <span class="number">1.111111111111111200000000000000</span> | <span class="number">1.111111111111111111111111111111</span> |</span><br><span class="line">+----------------------------------+----------------------------------+----------------------------------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<h3 id="表字段类型之日期"><a href="#表字段类型之日期" class="headerlink" title="表字段类型之日期"></a>表字段类型之日期</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">year</span><br><span class="line"></span><br><span class="line">time 时:分:秒 </span><br><span class="line">        </span><br><span class="line">date 年:月:日 </span><br><span class="line">        </span><br><span class="line">datetime 年:月:日 时:分:秒 </span><br><span class="line"></span><br><span class="line">timestamp 年:月:日 时:分:秒 </span><br><span class="line"></span><br><span class="line">create table t9(y year,t time,d date,dt datetime,ts timestamp);</span><br><span class="line">insert t9 values(now(),now(),now(),now(),now());</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> t9;</span><br><span class="line">+------+----------+------------+---------------------+---------------------+</span><br><span class="line">| y    | t        | d          | dt                  | ts                  |</span><br><span class="line">+------+----------+------------+---------------------+---------------------+</span><br><span class="line">| <span class="number">2020</span> | <span class="number">21</span>:<span class="number">34</span>:<span class="number">00</span> | <span class="number">2020</span>-09-01 | <span class="number">2020</span>-09-01 <span class="number">21</span>:<span class="number">34</span>:<span class="number">00</span> | <span class="number">2020</span>-09-01 <span class="number">21</span>:<span class="number">34</span>:<span class="number">00</span> |</span><br><span class="line">+------+----------+------------+---------------------+---------------------+</span><br><span class="line"></span><br><span class="line">create table t10 (</span><br><span class="line"><span class="built_in">id</span> <span class="built_in">int</span>,</span><br><span class="line">name varchar(<span class="number">8</span>),</span><br><span class="line">-- update_time datetime <span class="keyword">not</span> null default now() on update now(),</span><br><span class="line">update_time timestamp,</span><br><span class="line">reg_time datetime <span class="keyword">not</span> null default now() <span class="comment"># 不为空，默认值当前时间  </span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">insert into t10(<span class="built_in">id</span>, name) values(<span class="number">1</span>,<span class="string">&#x27;alex&#x27;</span>);</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> t10;</span><br><span class="line">+------+------+---------------------+---------------------+</span><br><span class="line">| <span class="built_in">id</span>   | name | update_time         | reg_time            |</span><br><span class="line">+------+------+---------------------+---------------------+</span><br><span class="line">|    <span class="number">1</span> | alex | <span class="number">2020</span>-09-01 <span class="number">21</span>:<span class="number">43</span>:<span class="number">38</span> | <span class="number">2020</span>-09-01 <span class="number">21</span>:<span class="number">43</span>:<span class="number">38</span> |</span><br><span class="line">+------+------+---------------------+---------------------+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">update t10 <span class="built_in">set</span> name = <span class="string">&#x27;lili&#x27;</span> where <span class="built_in">id</span> =<span class="number">1</span>;</span><br><span class="line">select * <span class="keyword">from</span> t10;</span><br><span class="line">+------+------+---------------------+---------------------+</span><br><span class="line">| <span class="built_in">id</span>   | name | update_time         | reg_time            |</span><br><span class="line">+------+------+---------------------+---------------------+</span><br><span class="line">|    <span class="number">1</span> | lili | <span class="number">2020</span>-09-01 <span class="number">21</span>:<span class="number">44</span>:<span class="number">36</span> | <span class="number">2020</span>-09-01 <span class="number">21</span>:<span class="number">43</span>:<span class="number">38</span> |</span><br><span class="line">+------+------+---------------------+---------------------+</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="表字段类型之字符"><a href="#表字段类型之字符" class="headerlink" title="表字段类型之字符"></a>表字段类型之字符</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">create table t11(x char(<span class="number">5</span>)); <span class="comment">#char 定长，不够则补全空格</span></span><br><span class="line">create table t12(x varchar(<span class="number">5</span>)); <span class="comment">#varchar 变长，预留1-2bytes来存储真实数据的长度</span></span><br><span class="line"></span><br><span class="line">insert into t11 values(<span class="string">&#x27;你好啊 &#x27;</span>);</span><br><span class="line">insert into t12 values(<span class="string">&#x27;你好啊 &#x27;</span>);</span><br><span class="line">t11=&gt;字符个数 <span class="number">5</span>  字节个数 <span class="number">11</span></span><br><span class="line">t12=&gt;字符个数 <span class="number">4</span>  字节个数 <span class="number">10</span></span><br><span class="line"></span><br><span class="line">select length(x) <span class="keyword">from</span> t11;</span><br><span class="line">+-----------+</span><br><span class="line">| length(x) |</span><br><span class="line">+-----------+</span><br><span class="line">|         <span class="number">9</span> |</span><br><span class="line">+-----------+</span><br><span class="line">select length(x) <span class="keyword">from</span> t12;</span><br><span class="line">+-----------+</span><br><span class="line">| length(x) |</span><br><span class="line">+-----------+</span><br><span class="line">|        <span class="number">10</span> |</span><br><span class="line">+-----------+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> sql_mode = <span class="string">&quot;pad_char_to_full_length&quot;</span>;</span><br><span class="line">select char_length(x) <span class="keyword">from</span> t11;</span><br><span class="line">+----------------+</span><br><span class="line">| char_length(x) |</span><br><span class="line">+----------------+</span><br><span class="line">|              <span class="number">5</span> |</span><br><span class="line">+----------------+</span><br><span class="line"></span><br><span class="line">select char_length(x) <span class="keyword">from</span> t12;</span><br><span class="line">+----------------+</span><br><span class="line">| char_length(x) |</span><br><span class="line">+----------------+</span><br><span class="line">|              <span class="number">4</span> |</span><br><span class="line">+----------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="表字段类型之枚举与集合"><a href="#表字段类型之枚举与集合" class="headerlink" title="表字段类型之枚举与集合"></a>表字段类型之枚举与集合</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">create table student(</span><br><span class="line"></span><br><span class="line">name varchar(<span class="number">10</span>) <span class="keyword">not</span> null,</span><br><span class="line">create table student(</span><br><span class="line"></span><br><span class="line">name varchar(<span class="number">10</span>) <span class="keyword">not</span> null,</span><br><span class="line"></span><br><span class="line">age <span class="built_in">int</span>(<span class="number">3</span>) unsigned <span class="keyword">not</span> null default <span class="number">18</span>,</span><br><span class="line"></span><br><span class="line">sex enum(<span class="string">&#x27;male&#x27;</span>,<span class="string">&#x27;female&#x27;</span>) default <span class="string">&#x27;male&#x27;</span>,</span><br><span class="line"></span><br><span class="line">hobby <span class="built_in">set</span> (<span class="string">&#x27;play&#x27;</span>,<span class="string">&#x27;study&#x27;</span>,<span class="string">&#x27;read&#x27;</span>,<span class="string">&#x27;music&#x27;</span>) default <span class="string">&#x27;play,music&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">alter table student add <span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment; <span class="comment"># 增加id字段</span></span><br><span class="line"></span><br><span class="line">insert into student(name,hobby) values(<span class="string">&#x27;alex&#x27;</span>,<span class="string">&#x27;study&#x27;</span>);</span><br><span class="line"></span><br><span class="line">insert into student(name,hobby) values(<span class="string">&#x27;lili&#x27;</span>,<span class="string">&#x27;read&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="表之间的三种关系"><a href="#表之间的三种关系" class="headerlink" title="表之间的三种关系"></a>表之间的三种关系</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 表 多对一</span></span><br><span class="line">create table press(</span><br><span class="line"><span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">name varchar(<span class="number">8</span>) <span class="keyword">not</span> null);</span><br><span class="line"></span><br><span class="line">create table book(</span><br><span class="line"><span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">name varchar(<span class="number">9</span>) <span class="keyword">not</span> null,</span><br><span class="line">press_id <span class="built_in">int</span> <span class="keyword">not</span> null,</span><br><span class="line">foreign key(press_id) references press(<span class="built_in">id</span>)</span><br><span class="line">on delete cascade</span><br><span class="line">on update cascade</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">insert into press(name) values(<span class="string">&#x27;新经典&#x27;</span>),(<span class="string">&#x27;北京工业&#x27;</span>);</span><br><span class="line">insert into book(name,press_id) values(<span class="string">&#x27;白夜行&#x27;</span>,<span class="number">1</span>),(<span class="string">&#x27;沉睡的森林&#x27;</span>,<span class="number">2</span>),(<span class="string">&#x27;祈祷落幕时&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">update press <span class="built_in">set</span> <span class="built_in">id</span>=<span class="number">3</span> where <span class="built_in">id</span> =<span class="number">2</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment"># 多对多</span></span><br><span class="line">create table author(</span><br><span class="line"><span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">name varchar(<span class="number">8</span>) <span class="keyword">not</span> null);</span><br><span class="line"></span><br><span class="line">create table author_book(</span><br><span class="line"><span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">name varchar(<span class="number">8</span>) <span class="keyword">not</span> null,</span><br><span class="line">author_id <span class="built_in">int</span> <span class="keyword">not</span> null,</span><br><span class="line">book_id <span class="built_in">int</span> <span class="keyword">not</span> null,</span><br><span class="line">foreign key (author_id) references author(<span class="built_in">id</span>)</span><br><span class="line">on delete cascade</span><br><span class="line">on update cascade,</span><br><span class="line">foreign key (book_id) references book(<span class="built_in">id</span>)</span><br><span class="line">on delete cascade</span><br><span class="line">on update cascade</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">insert into author(name) values(<span class="string">&#x27;egon&#x27;</span>),(<span class="string">&#x27;alex&#x27;</span>),(<span class="string">&#x27;yuanhao&#x27;</span>),(<span class="string">&#x27;wpq&#x27;</span>);</span><br><span class="line"></span><br><span class="line">insert into author_book(author_id,book_id) values</span><br><span class="line">(<span class="number">1</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="number">1</span>,<span class="number">2</span>),</span><br><span class="line">(<span class="number">1</span>,<span class="number">3</span>),</span><br><span class="line">(<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 一对一</span></span><br><span class="line">create table customer(</span><br><span class="line">    <span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">    name varchar(<span class="number">16</span>),</span><br><span class="line">    phone char(<span class="number">11</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">create table student(</span><br><span class="line">    <span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">varchar</span>(<span class="params"><span class="number">10</span></span>),</span></span><br><span class="line"><span class="class">    <span class="title">course</span> <span class="title">varchar</span>(<span class="params"><span class="number">16</span></span>),</span></span><br><span class="line"><span class="class">    <span class="title">c_id</span> <span class="title">int</span> <span class="title">unique</span>,</span></span><br><span class="line"><span class="class">    <span class="title">foreign</span> <span class="title">key</span>(<span class="params">c_id</span>) <span class="title">references</span> <span class="title">customer</span>(<span class="params"><span class="built_in">id</span></span>) <span class="title">on</span> <span class="title">delete</span> <span class="title">cascade</span> <span class="title">on</span> <span class="title">update</span> <span class="title">cascade</span></span></span><br><span class="line"><span class="class">);</span></span><br></pre></td></tr></table></figure>

<h3 id="单表查询"><a href="#单表查询" class="headerlink" title="单表查询"></a>单表查询</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 插入</span></span><br><span class="line">mysql&gt; create table user(name varchar(<span class="number">16</span>),password varchar(<span class="number">10</span>));</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.29</span> sec)</span><br><span class="line">mysql&gt;</span><br><span class="line">mysql&gt; insert into user select user,password <span class="keyword">from</span> mysql.user;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除</span></span><br><span class="line">delete <span class="keyword">from</span> 表 where 条件;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新</span></span><br><span class="line">update 表 <span class="built_in">set</span> 字段=值 where 条件;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 单表查询语法</span></span><br><span class="line">select distinct 字段<span class="number">1</span>,字段<span class="number">2</span>,字段<span class="number">3</span>,... <span class="keyword">from</span> 表名</span><br><span class="line">                            where 过滤条件</span><br><span class="line">                            group by 分组的条件</span><br><span class="line">                            having 筛选条件</span><br><span class="line">                            order by 排序字段</span><br><span class="line">                            limit n;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 简单查询</span></span><br><span class="line">select name,sex <span class="keyword">from</span> emp;</span><br><span class="line">select name <span class="keyword">as</span> 名字,sex 性别 <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 避免重复（针对的是记录）</span></span><br><span class="line"><span class="comment"># 不能去重带主键和唯一</span></span><br><span class="line">select distinct post <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行四则运算</span></span><br><span class="line">select name <span class="keyword">as</span> 名字,salary*<span class="number">12</span> <span class="keyword">as</span> 年薪 <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment"># concat()拼接记录的内容</span></span><br><span class="line">select name ,concat(salary*<span class="number">12</span>,<span class="string">&quot;$&quot;</span>) <span class="keyword">from</span> emp;</span><br><span class="line">select name ,concat(<span class="string">&quot;annual_salary&quot;</span>,<span class="string">&#x27;:&#x27;</span>,salary*<span class="number">12</span>) <span class="keyword">as</span> 年薪 <span class="keyword">from</span> emp;</span><br><span class="line">select name ,concat(<span class="string">&quot;annual_salary&quot;</span>,<span class="string">&#x27;:&#x27;</span>,salary*<span class="number">12</span>,<span class="string">&#x27;:&#x27;</span>,<span class="string">&#x27;$&#x27;</span>) <span class="keyword">as</span> 年薪 <span class="keyword">from</span> emp;</span><br><span class="line">select name ,concat_ws(<span class="string">&quot;:&quot;</span>,<span class="string">&quot;annual_salary&quot;</span>,salary*<span class="number">12</span>,<span class="string">&#x27;$&#x27;</span>) <span class="keyword">as</span> 年薪 <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select (</span><br><span class="line">    case</span><br><span class="line">    when name=<span class="string">&quot;egon&quot;</span> then</span><br><span class="line">        name</span><br><span class="line">    when name=<span class="string">&quot;alex&quot;</span> then</span><br><span class="line">        concat(name,<span class="string">&quot;_dsb&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        concat(name,<span class="string">&quot;_sb&quot;</span>)</span><br><span class="line">    end</span><br><span class="line">) <span class="keyword">as</span> 名字 <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===========================================where</span><br><span class="line">select * <span class="keyword">from</span> emp where <span class="built_in">id</span> &gt;= <span class="number">3</span> <span class="keyword">and</span> <span class="built_in">id</span> &lt;= <span class="number">5</span>;</span><br><span class="line">select * <span class="keyword">from</span> emp where <span class="built_in">id</span> between <span class="number">3</span> <span class="keyword">and</span> <span class="number">5</span>;</span><br><span class="line">select * <span class="keyword">from</span> emp where <span class="built_in">id</span> <span class="keyword">not</span> between <span class="number">3</span> <span class="keyword">and</span> <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> emp where <span class="built_in">id</span>=<span class="number">3</span> <span class="keyword">or</span> <span class="built_in">id</span>=<span class="number">5</span> <span class="keyword">or</span> <span class="built_in">id</span>=<span class="number">7</span>;</span><br><span class="line">select * <span class="keyword">from</span> emp where <span class="built_in">id</span> <span class="keyword">in</span> (<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>);</span><br><span class="line">select * <span class="keyword">from</span> emp where <span class="built_in">id</span> <span class="keyword">not</span> <span class="keyword">in</span> (<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>);</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> emp where <span class="built_in">id</span>=<span class="number">3</span> <span class="keyword">or</span> <span class="built_in">id</span>=<span class="number">5</span> <span class="keyword">or</span> <span class="built_in">id</span>=<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> emp where name like <span class="string">&#x27;jin%&#x27;</span>;</span><br><span class="line">select * <span class="keyword">from</span> emp where name like <span class="string">&#x27;jin___&#x27;</span>;</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> emp where name regexp <span class="string">&#x27;n$&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> emp where post_comment <span class="keyword">is</span> <span class="keyword">not</span> null;</span><br><span class="line">Empty <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; update emp <span class="built_in">set</span> post_comment=<span class="string">&#x27;&#x27;</span> where <span class="built_in">id</span>=<span class="number">3</span>;</span><br><span class="line">Query OK, <span class="number">1</span> row affected (<span class="number">0.07</span> sec)</span><br><span class="line">Rows matched: <span class="number">1</span>  Changed: <span class="number">1</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> emp where post_comment <span class="keyword">is</span> <span class="keyword">not</span> null;</span><br><span class="line">+----+---------+------+-----+------------+---------+--------------+---------+--------+-----------+</span><br><span class="line">| <span class="built_in">id</span> | name    | sex  | age | hire_date  | post    | post_comment | salary  | office | depart_id |</span><br><span class="line">+----+---------+------+-----+------------+---------+--------------+---------+--------+-----------+</span><br><span class="line">|  <span class="number">3</span> | wupeiqi | male |  <span class="number">81</span> | <span class="number">2013</span>-03-05 | teacher |              | <span class="number">8300.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">+----+---------+------+-----+------------+---------+--------------+---------+--------+-----------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> emp where name=<span class="string">&quot;丫丫&quot;</span>;</span><br><span class="line">select * <span class="keyword">from</span> emp where name regexp <span class="string">&quot;丫$&quot;</span>;</span><br><span class="line">select * <span class="keyword">from</span> emp where name like <span class="string">&quot;丫_&quot;</span>;</span><br><span class="line">select * <span class="keyword">from</span> emp where name regexp <span class="string">&quot;^程&quot;</span>;</span><br><span class="line">select <span class="built_in">hex</span>(name) <span class="keyword">from</span> t4  where <span class="built_in">hex</span>(name) regexp <span class="string">&#x27;e[4-9][0-9a-f]&#123;4&#125;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===========================================group by</span><br><span class="line">分完组之后只能看到分组的字段以及聚合的结果</span><br><span class="line"></span><br><span class="line"><span class="built_in">max</span>()</span><br><span class="line"><span class="built_in">min</span>()</span><br><span class="line">avg()</span><br><span class="line"><span class="built_in">sum</span>()</span><br><span class="line">count()</span><br><span class="line"></span><br><span class="line">select depart_id,count(<span class="built_in">id</span>),avg(salary),<span class="built_in">max</span>(age),<span class="built_in">min</span>(salary),<span class="built_in">sum</span>(salary) <span class="keyword">from</span> emp group by depart_id;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每个部门都有多少个人</span></span><br><span class="line">select depart_id,count(<span class="built_in">id</span>) <span class="keyword">from</span> emp group by depart_id;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每个职位男生的平均薪资</span></span><br><span class="line">select post,avg(salary) <span class="keyword">from</span> emp where sex=<span class="string">&quot;male&quot;</span> group by post;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select post, group_concat(name) <span class="keyword">from</span> emp group by post;</span><br><span class="line">select post, group_concat(name) <span class="keyword">from</span> emp where sex=<span class="string">&quot;male&quot;</span> group by post;</span><br><span class="line"></span><br><span class="line">===========================================having</span><br><span class="line"><span class="comment"># having与where本质区别就是在于having是在分组之后发生过滤，可以使用聚合函数</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select <span class="built_in">max</span>(salary) <span class="keyword">from</span> emp where <span class="built_in">max</span>(salary) &gt; <span class="number">100000</span>;</span><br><span class="line">ERROR <span class="number">1111</span> (HY000): Invalid use of group function</span><br><span class="line">mysql&gt; select <span class="built_in">max</span>(salary) <span class="keyword">from</span> emp having <span class="built_in">max</span>(salary) &gt; <span class="number">100000</span>;</span><br><span class="line">+-------------+</span><br><span class="line">| <span class="built_in">max</span>(salary) |</span><br><span class="line">+-------------+</span><br><span class="line">|  <span class="number">1000000.31</span> |</span><br><span class="line">+-------------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 找出来男生平均薪资大于3000的职位</span></span><br><span class="line"></span><br><span class="line">select post,avg(salary) <span class="keyword">from</span> emp where sex=<span class="string">&quot;male&quot;</span> group by post having avg(salary) &gt; <span class="number">8000</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===========================================order by排序</span><br><span class="line">select * <span class="keyword">from</span> emp order by salary;</span><br><span class="line"> select * <span class="keyword">from</span> emp order by salary desc;</span><br><span class="line"> select * <span class="keyword">from</span> emp order by age,<span class="built_in">id</span> desc;</span><br><span class="line"></span><br><span class="line"> select post,avg(salary) <span class="keyword">from</span> emp where sex=<span class="string">&quot;male&quot;</span> group by post having avg(salary) &gt; <span class="number">3000</span>;</span><br><span class="line"> mysql&gt; select post,avg(salary) <span class="keyword">from</span> emp where sex=<span class="string">&quot;male&quot;</span> group by post having avg(salary) &gt; <span class="number">3000</span>;</span><br><span class="line">+-----------------------------------------+---------------+</span><br><span class="line">| post                                    | avg(salary)   |</span><br><span class="line">+-----------------------------------------+---------------+</span><br><span class="line">| operation                               |  <span class="number">16000.043333</span> |</span><br><span class="line">| teacher                                 | <span class="number">175650.051667</span> |</span><br><span class="line">| 老男孩驻沙河办事处外交大使              |   <span class="number">7300.330000</span> |</span><br><span class="line">+-----------------------------------------+---------------+</span><br><span class="line"><span class="number">3</span> rows <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select post,avg(salary) <span class="keyword">from</span> emp where sex=<span class="string">&quot;male&quot;</span> group by post having avg(salary) &gt; <span class="number">3000</span> order by avg(salary);</span><br><span class="line">+-----------------------------------------+---------------+</span><br><span class="line">| post                                    | avg(salary)   |</span><br><span class="line">+-----------------------------------------+---------------+</span><br><span class="line">| 老男孩驻沙河办事处外交大使              |   <span class="number">7300.330000</span> |</span><br><span class="line">| operation                               |  <span class="number">16000.043333</span> |</span><br><span class="line">| teacher                                 | <span class="number">175650.051667</span> |</span><br><span class="line">+-----------------------------------------+---------------+</span><br><span class="line"><span class="number">3</span> rows <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select post,avg(salary) <span class="keyword">as</span> v <span class="keyword">from</span> emp where sex=<span class="string">&quot;male&quot;</span> group by post having avg(salary) &gt; <span class="number">3000</span> order by v;</span><br><span class="line">+-----------------------------------------+---------------+</span><br><span class="line">| post                                    | v             |</span><br><span class="line">+-----------------------------------------+---------------+</span><br><span class="line">| 老男孩驻沙河办事处外交大使              |   <span class="number">7300.330000</span> |</span><br><span class="line">| operation                               |  <span class="number">16000.043333</span> |</span><br><span class="line">| teacher                                 | <span class="number">175650.051667</span> |</span><br><span class="line">+-----------------------------------------+---------------+</span><br><span class="line"><span class="number">3</span> rows <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> emp limit <span class="number">0</span>,<span class="number">5</span>;</span><br><span class="line">select * <span class="keyword">from</span> emp limit <span class="number">5</span>,<span class="number">5</span>;</span><br><span class="line">select * <span class="keyword">from</span> emp limit <span class="number">10</span>,<span class="number">5</span>;</span><br><span class="line">select * <span class="keyword">from</span> emp limit <span class="number">15</span>,<span class="number">5</span>;</span><br><span class="line">select * <span class="keyword">from</span> emp limit <span class="number">20</span>,<span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">create table dep(</span><br><span class="line"><span class="built_in">id</span> <span class="built_in">int</span>,</span><br><span class="line">name varchar(<span class="number">20</span>) </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">create table emp(</span><br><span class="line"><span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">name varchar(<span class="number">20</span>),</span><br><span class="line">sex enum(<span class="string">&#x27;male&#x27;</span>,<span class="string">&#x27;female&#x27;</span>) <span class="keyword">not</span> null default <span class="string">&#x27;male&#x27;</span>,</span><br><span class="line">age <span class="built_in">int</span>,</span><br><span class="line">dep_id <span class="built_in">int</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">#插入数据</span></span><br><span class="line">insert into dep values</span><br><span class="line">(<span class="number">200</span>,<span class="string">&#x27;技术&#x27;</span>),</span><br><span class="line">(<span class="number">201</span>,<span class="string">&#x27;人力资源&#x27;</span>),</span><br><span class="line">(<span class="number">202</span>,<span class="string">&#x27;销售&#x27;</span>),</span><br><span class="line">(<span class="number">203</span>,<span class="string">&#x27;运营&#x27;</span>);</span><br><span class="line"></span><br><span class="line">insert into emp(name,sex,age,dep_id) values</span><br><span class="line">(<span class="string">&#x27;egon&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">18</span>,<span class="number">200</span>),</span><br><span class="line">(<span class="string">&#x27;alex&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">48</span>,<span class="number">201</span>),</span><br><span class="line">(<span class="string">&#x27;wupeiqi&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">38</span>,<span class="number">201</span>),</span><br><span class="line">(<span class="string">&#x27;yuanhao&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">28</span>,<span class="number">202</span>),</span><br><span class="line">(<span class="string">&#x27;liwenzhou&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">18</span>,<span class="number">200</span>),</span><br><span class="line">(<span class="string">&#x27;jingliyang&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">18</span>,<span class="number">204</span>)</span><br><span class="line">;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1 交叉连接：不适用任何匹配条件。生成笛卡尔积</span></span><br><span class="line">select * <span class="keyword">from</span> dep,emp;</span><br><span class="line"><span class="comment"># 2 内连接：只连接匹配的行</span></span><br><span class="line">select * <span class="keyword">from</span> emp,dep where emp.dep_id = dep.<span class="built_in">id</span>;</span><br><span class="line">select * <span class="keyword">from</span> emp inner join dep on emp.dep_id = dep.<span class="built_in">id</span>;</span><br><span class="line"><span class="comment"># 3 外链接之左连接：优先显示左表全部记录</span></span><br><span class="line">select * <span class="keyword">from</span> emp left join dep on emp.dep_id = dep.<span class="built_in">id</span>;</span><br><span class="line">+----+------------+--------+------+--------+------+--------------+</span><br><span class="line">| <span class="built_in">id</span> | name       | sex    | age  | dep_id | <span class="built_in">id</span>   | name         |</span><br><span class="line">+----+------------+--------+------+--------+------+--------------+</span><br><span class="line">|  <span class="number">1</span> | egon       | male   |   <span class="number">18</span> |    <span class="number">200</span> |  <span class="number">200</span> | 技术         |</span><br><span class="line">|  <span class="number">5</span> | liwenzhou  | male   |   <span class="number">18</span> |    <span class="number">200</span> |  <span class="number">200</span> | 技术         |</span><br><span class="line">|  <span class="number">2</span> | alex       | female |   <span class="number">48</span> |    <span class="number">201</span> |  <span class="number">201</span> | 人力资源     |</span><br><span class="line">|  <span class="number">3</span> | wupeiqi    | male   |   <span class="number">38</span> |    <span class="number">201</span> |  <span class="number">201</span> | 人力资源     |</span><br><span class="line">|  <span class="number">4</span> | yuanhao    | female |   <span class="number">28</span> |    <span class="number">202</span> |  <span class="number">202</span> | 销售         |</span><br><span class="line">|  <span class="number">6</span> | jingliyang | female |   <span class="number">18</span> |    <span class="number">204</span> | NULL | NULL         |</span><br><span class="line">+----+------------+--------+------+--------+------+--------------+</span><br><span class="line"><span class="comment"># 4 外链接之右连接：优先显示右表全部记录</span></span><br><span class="line">select * <span class="keyword">from</span> emp right join dep on emp.dep_id = dep.<span class="built_in">id</span>;</span><br><span class="line">+------+-----------+--------+------+--------+------+--------------+</span><br><span class="line">| <span class="built_in">id</span>   | name      | sex    | age  | dep_id | <span class="built_in">id</span>   | name         |</span><br><span class="line">+------+-----------+--------+------+--------+------+--------------+</span><br><span class="line">|    <span class="number">1</span> | egon      | male   |   <span class="number">18</span> |    <span class="number">200</span> |  <span class="number">200</span> | 技术         |</span><br><span class="line">|    <span class="number">2</span> | alex      | female |   <span class="number">48</span> |    <span class="number">201</span> |  <span class="number">201</span> | 人力资源     |</span><br><span class="line">|    <span class="number">3</span> | wupeiqi   | male   |   <span class="number">38</span> |    <span class="number">201</span> |  <span class="number">201</span> | 人力资源     |</span><br><span class="line">|    <span class="number">4</span> | yuanhao   | female |   <span class="number">28</span> |    <span class="number">202</span> |  <span class="number">202</span> | 销售         |</span><br><span class="line">|    <span class="number">5</span> | liwenzhou | male   |   <span class="number">18</span> |    <span class="number">200</span> |  <span class="number">200</span> | 技术         |</span><br><span class="line">| NULL | NULL      | NULL   | NULL |   NULL |  <span class="number">203</span> | 运营         |</span><br><span class="line">+------+-----------+--------+------+--------+------+--------------+</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5 全外连接：显示左右两个表全部记录</span></span><br><span class="line">select * <span class="keyword">from</span> emp left join dep on emp.dep_id = dep.<span class="built_in">id</span></span><br><span class="line">union </span><br><span class="line">select * <span class="keyword">from</span> emp right join dep on emp.dep_id = dep.<span class="built_in">id</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># =================== 符合条件连接查询</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 员工年龄&gt;25 的姓名，所在部门和年纪</span></span><br><span class="line">select emp.name,dep.name,age <span class="keyword">from</span> emp inner join dep on emp.dep_id = dep.<span class="built_in">id</span> where age&gt;<span class="number">25</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment"># =====================子查询</span></span><br><span class="line"><span class="comment"># 查询平均年龄在25岁以上的部门名</span></span><br><span class="line"><span class="comment"># 方式一</span></span><br><span class="line">select dep.name, dep_id <span class="keyword">from</span> emp inner join dep on emp.dep_id = dep.<span class="built_in">id</span> group by dep_id having avg(age)&gt;<span class="number">25</span>;  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 方式二</span></span><br><span class="line">select <span class="built_in">id</span>,name <span class="keyword">from</span> dep</span><br><span class="line">    where <span class="built_in">id</span> <span class="keyword">in</span> </span><br><span class="line">        (select dep_id <span class="keyword">from</span> emp group by dep_id having avg(age) &gt; <span class="number">25</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看技术部员工姓名</span></span><br><span class="line"><span class="comment"># 方式一</span></span><br><span class="line">select name <span class="keyword">from</span> emp where dep_id <span class="keyword">in</span>(select <span class="built_in">id</span> <span class="keyword">from</span> dep where name=<span class="string">&#x27;技术&#x27;</span>);</span><br><span class="line"><span class="comment"># 方式二</span></span><br><span class="line">select emp.name <span class="keyword">from</span> emp inner join dep on emp.dep_id = dep.<span class="built_in">id</span> where dep.name =<span class="string">&#x27;技术&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">create table <span class="class"><span class="keyword">class</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="class">    <span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span></span></span><br><span class="line"><span class="params"><span class="class">    name varchar(<span class="params"><span class="number">16</span></span>) unique</span></span></span><br><span class="line"><span class="params"><span class="class"></span>);</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">create</span> <span class="title">table</span> <span class="title">student</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="class"><span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span></span></span><br><span class="line"><span class="params"><span class="class">name varchar(<span class="params"><span class="number">10</span></span>),</span></span></span><br><span class="line"><span class="params"><span class="class">gendenr varchar(<span class="params"><span class="number">6</span></span>),</span></span></span><br><span class="line"><span class="params"><span class="class">cid <span class="built_in">int</span> <span class="keyword">not</span> null,</span></span></span><br><span class="line"><span class="params"><span class="class">foreign key(<span class="params">cid</span>) references <span class="keyword">class</span>(<span class="params"><span class="built_in">id</span></span>)</span></span></span><br><span class="line"><span class="params"><span class="class">on delete cascade</span></span></span><br><span class="line"><span class="params"><span class="class">on update cascade</span></span></span><br><span class="line"><span class="params"><span class="class"></span>);</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">create</span> <span class="title">table</span> <span class="title">teacher</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="class"><span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span></span></span><br><span class="line"><span class="params"><span class="class">name varchar(<span class="params"><span class="number">10</span></span>)</span></span></span><br><span class="line"><span class="params"><span class="class"></span>);</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">create</span> <span class="title">table</span> <span class="title">course</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="class"><span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span></span></span><br><span class="line"><span class="params"><span class="class">name varchar(<span class="params"><span class="number">10</span></span>),</span></span></span><br><span class="line"><span class="params"><span class="class">tid <span class="built_in">int</span> <span class="keyword">not</span> null,</span></span></span><br><span class="line"><span class="params"><span class="class">foreign key(<span class="params">tid</span>) references teacher(<span class="params"><span class="built_in">id</span></span>)</span></span></span><br><span class="line"><span class="params"><span class="class">on delete cascade</span></span></span><br><span class="line"><span class="params"><span class="class">on update cascade </span></span></span><br><span class="line"><span class="params"><span class="class"></span>);</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">create</span> <span class="title">table</span> <span class="title">score</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="class"><span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span></span></span><br><span class="line"><span class="params"><span class="class">fraction <span class="built_in">int</span> <span class="keyword">not</span> null,</span></span></span><br><span class="line"><span class="params"><span class="class">sid <span class="built_in">int</span> <span class="keyword">not</span> null,</span></span></span><br><span class="line"><span class="params"><span class="class">cid <span class="built_in">int</span> <span class="keyword">not</span> null,</span></span></span><br><span class="line"><span class="params"><span class="class">foreign key(<span class="params">sid</span>) references student(<span class="params"><span class="built_in">id</span></span>)</span></span></span><br><span class="line"><span class="params"><span class="class">on delete cascade</span></span></span><br><span class="line"><span class="params"><span class="class">on update cascade,</span></span></span><br><span class="line"><span class="params"><span class="class">foreign key(<span class="params">cid</span>) references course(<span class="params"><span class="built_in">id</span></span>)</span></span></span><br><span class="line"><span class="params"><span class="class">on delete cascade</span></span></span><br><span class="line"><span class="params"><span class="class">on update cascade </span></span></span><br><span class="line"><span class="params"><span class="class"></span>);</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"># 班级表插入数据</span></span><br><span class="line"><span class="class"><span class="title">insert</span> <span class="title">into</span> <span class="title">class</span>(<span class="params">name</span>) <span class="title">values</span>(<span class="params"><span class="string">&#x27;十五期一班&#x27;</span></span>),(<span class="params"><span class="string">&#x27;十四期二班&#x27;</span></span>),(<span class="params"><span class="string">&#x27;十六期三班&#x27;</span></span>);</span></span><br><span class="line"><span class="class"># 学生表插入数据</span></span><br><span class="line"><span class="class"><span class="title">insert</span> <span class="title">into</span> <span class="title">student</span>(<span class="params">name,gender,cid</span>) <span class="title">values</span>(<span class="params"><span class="string">&#x27;钢弹&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">1</span></span>),(<span class="params"><span class="string">&#x27;铁锤&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">2</span></span>),(<span class="params"><span class="string">&#x27;莉莉&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">3</span></span>);</span></span><br><span class="line"><span class="class"># 老师表插入数据</span></span><br><span class="line"><span class="class"><span class="title">insert</span> <span class="title">into</span> <span class="title">teacher</span>(<span class="params">name</span>) <span class="title">values</span>(<span class="params"><span class="string">&#x27;egon&#x27;</span></span>),(<span class="params"><span class="string">&#x27;lxx&#x27;</span></span>),(<span class="params"><span class="string">&#x27;jason&#x27;</span></span>);</span></span><br><span class="line"><span class="class"># 课程表插入数据</span></span><br><span class="line"><span class="class"><span class="title">insert</span> <span class="title">into</span> <span class="title">course</span>(<span class="params">name,tid</span>) <span class="title">values</span>(<span class="params"><span class="string">&#x27;python&#x27;</span>,<span class="number">1</span></span>),(<span class="params"><span class="string">&#x27;go&#x27;</span>,<span class="number">2</span></span>),(<span class="params"><span class="string">&#x27;linux&#x27;</span>,<span class="number">1</span></span>);</span></span><br><span class="line"><span class="class"># 成绩表插入数据</span></span><br><span class="line"><span class="class"><span class="title">insert</span> <span class="title">into</span> <span class="title">score</span>(<span class="params">fraction,cid,sid</span>) <span class="title">values</span>(<span class="params"><span class="number">80</span>,<span class="number">2</span>,<span class="number">1</span></span>),(<span class="params"><span class="number">90</span>,<span class="number">3</span>,<span class="number">3</span></span>);</span></span><br></pre></td></tr></table></figure>

<h3 id="权限管理"><a href="#权限管理" class="headerlink" title="权限管理"></a>权限管理</h3><p><img src="/2020/08/20/MySQL/image-20210307060739486.png" alt="Mysql"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#授权表</span></span><br><span class="line">user <span class="comment">#该表放行的权限，针对：所有数据，所有库下所有表，以及表下的所有字段</span></span><br><span class="line">db <span class="comment">#该表放行的权限，针对：某一数据库，该数据库下的所有表，以及表下的所有字段</span></span><br><span class="line">tables_priv <span class="comment">#该表放行的权限。针对：某一张表，以及该表下的所有字段</span></span><br><span class="line">columns_priv <span class="comment">#该表放行的权限，针对：某一个字段</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#按图解释：</span></span><br><span class="line">user：放行db1，db2及其包含的所有</span><br><span class="line">db：放行db1，及其db1包含的所有</span><br><span class="line">tables_priv:放行db1.table1，及其该表包含的所有</span><br><span class="line">columns_prive:放行db1.table1.column1，只放行该字段</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建用户</span></span><br><span class="line">create user <span class="string">&#x27;egon&#x27;</span>@<span class="string">&#x27;1.1.1.1&#x27;</span> identified by <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line">create user <span class="string">&#x27;egon&#x27;</span>@<span class="string">&#x27;192.168.1.%&#x27;</span> identified by <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line">create user <span class="string">&#x27;egon&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified by <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#授权：对文件夹，对文件，对文件某一字段的权限</span></span><br><span class="line">查看帮助：<span class="built_in">help</span> grant</span><br><span class="line">常用权限有：select,update,alter,delete</span><br><span class="line"><span class="built_in">all</span>可以代表除了grant之外的所有权限</span><br><span class="line"></span><br><span class="line"><span class="comment">#针对所有库的授权:*.*</span></span><br><span class="line">grant select on *.* to <span class="string">&#x27;egon1&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified by <span class="string">&#x27;123&#x27;</span>; <span class="comment">#只在user表中可以查到egon1用户的select权限被设置为Y</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#针对某一数据库：db1.*</span></span><br><span class="line">grant select on db1.* to <span class="string">&#x27;egon2&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified by <span class="string">&#x27;123&#x27;</span>; <span class="comment">#只在db表中可以查到egon2用户的select权限被设置为Y</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#针对某一个表：db1.t1</span></span><br><span class="line">grant select on db1.t1 to <span class="string">&#x27;egon3&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified by <span class="string">&#x27;123&#x27;</span>;  <span class="comment">#只在tables_priv表中可以查到egon3用户的select权限</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#针对某一个字段：</span></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> t3;</span><br><span class="line">+------+-------+------+</span><br><span class="line">| <span class="built_in">id</span>   | name  | age  |</span><br><span class="line">+------+-------+------+</span><br><span class="line">|    <span class="number">1</span> | egon1 |   <span class="number">18</span> |</span><br><span class="line">|    <span class="number">2</span> | egon2 |   <span class="number">19</span> |</span><br><span class="line">|    <span class="number">3</span> | egon3 |   <span class="number">29</span> |</span><br><span class="line">+------+-------+------+</span><br><span class="line"></span><br><span class="line">grant select (<span class="built_in">id</span>,name),update (age) on db1.t3 to <span class="string">&#x27;egon4&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified by <span class="string">&#x27;123&#x27;</span>; </span><br><span class="line"><span class="comment">#可以在tables_priv和columns_priv中看到相应的权限</span></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> tables_priv where user=<span class="string">&#x27;egon4&#x27;</span>\G</span><br><span class="line">*************************** <span class="number">1.</span> row ***************************</span><br><span class="line">       Host: localhost</span><br><span class="line">         Db: db1</span><br><span class="line">       User: egon4</span><br><span class="line"> Table_name: t3</span><br><span class="line">    Grantor: root@localhost</span><br><span class="line">  Timestamp: <span class="number">0000</span>-<span class="number">00</span>-<span class="number">00</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"> Table_priv:</span><br><span class="line">Column_priv: Select,Update</span><br><span class="line">row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> columns_priv where user=<span class="string">&#x27;egon4&#x27;</span>\G</span><br><span class="line">*************************** <span class="number">1.</span> row ***************************</span><br><span class="line">       Host: localhost</span><br><span class="line">         Db: db1</span><br><span class="line">       User: egon4</span><br><span class="line"> Table_name: t3</span><br><span class="line">Column_name: <span class="built_in">id</span></span><br><span class="line">  Timestamp: <span class="number">0000</span>-<span class="number">00</span>-<span class="number">00</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">Column_priv: Select</span><br><span class="line">*************************** <span class="number">2.</span> row ***************************</span><br><span class="line">       Host: localhost</span><br><span class="line">         Db: db1</span><br><span class="line">       User: egon4</span><br><span class="line"> Table_name: t3</span><br><span class="line">Column_name: name</span><br><span class="line">  Timestamp: <span class="number">0000</span>-<span class="number">00</span>-<span class="number">00</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">Column_priv: Select</span><br><span class="line">*************************** <span class="number">3.</span> row ***************************</span><br><span class="line">       Host: localhost</span><br><span class="line">         Db: db1</span><br><span class="line">       User: egon4</span><br><span class="line"> Table_name: t3</span><br><span class="line">Column_name: age</span><br><span class="line">  Timestamp: <span class="number">0000</span>-<span class="number">00</span>-<span class="number">00</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">Column_priv: Update</span><br><span class="line">rows <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment">#删除权限</span></span><br><span class="line">revoke select on db1.* <span class="keyword">from</span> <span class="string">&#x27;egon&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">权限相关操作</span><br></pre></td></tr></table></figure>

<h3 id="SQL语句查询执行顺序"><a href="#SQL语句查询执行顺序" class="headerlink" title="SQL语句查询执行顺序"></a>SQL语句查询执行顺序</h3><h4 id="SELECT语句关键字的定义顺序"><a href="#SELECT语句关键字的定义顺序" class="headerlink" title="SELECT语句关键字的定义顺序"></a>SELECT语句关键字的定义顺序</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT DISTINCT &lt;select_list&gt;</span><br><span class="line">FROM &lt;left_table&gt;</span><br><span class="line">&lt;join_type&gt; JOIN &lt;right_table&gt;</span><br><span class="line">ON &lt;join_condition&gt;</span><br><span class="line">WHERE &lt;where_condition&gt;</span><br><span class="line">GROUP BY &lt;group_by_list&gt;</span><br><span class="line">HAVING &lt;having_condition&gt;</span><br><span class="line">ORDER BY &lt;order_by_condition&gt;</span><br><span class="line">LIMIT &lt;limit_number&gt;</span><br></pre></td></tr></table></figure>

<h4 id="SELECT语句关键字的执行顺序"><a href="#SELECT语句关键字的执行顺序" class="headerlink" title="SELECT语句关键字的执行顺序"></a>SELECT语句关键字的执行顺序</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">7</span>)     SELECT </span><br><span class="line">(<span class="number">8</span>)     DISTINCT &lt;select_list&gt;</span><br><span class="line">(<span class="number">1</span>)     FROM &lt;left_table&gt;</span><br><span class="line">(<span class="number">3</span>)     &lt;join_type&gt; JOIN &lt;right_table&gt;</span><br><span class="line">(<span class="number">2</span>)     ON &lt;join_condition&gt;</span><br><span class="line">(<span class="number">4</span>)     WHERE &lt;where_condition&gt;</span><br><span class="line">(<span class="number">5</span>)     GROUP BY &lt;group_by_list&gt;</span><br><span class="line">(<span class="number">6</span>)     HAVING &lt;having_condition&gt;</span><br><span class="line">(<span class="number">9</span>)     ORDER BY &lt;order_by_condition&gt;</span><br><span class="line">(<span class="number">10</span>)    LIMIT &lt;limit_number&gt;</span><br></pre></td></tr></table></figure>

<h4 id="准备表和数据"><a href="#准备表和数据" class="headerlink" title="准备表和数据"></a>准备表和数据</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 新建一个测试数据库TestDB；</span><br><span class="line"></span><br><span class="line">create database TestDB;</span><br><span class="line"><span class="number">2.</span>创建测试表table1和table2；</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CREATE TABLE table1</span><br><span class="line"> (</span><br><span class="line">     customer_id VARCHAR(<span class="number">10</span>) NOT NULL,</span><br><span class="line">     city VARCHAR(<span class="number">10</span>) NOT NULL,</span><br><span class="line">     PRIMARY KEY(customer_id)</span><br><span class="line"> )ENGINE=INNODB DEFAULT CHARSET=UTF8;</span><br><span class="line"></span><br><span class="line"> CREATE TABLE table2</span><br><span class="line"> (</span><br><span class="line">     order_id INT NOT NULL auto_increment,</span><br><span class="line">     customer_id VARCHAR(<span class="number">10</span>),</span><br><span class="line">     PRIMARY KEY(order_id)</span><br><span class="line"> )ENGINE=INNODB DEFAULT CHARSET=UTF8;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>插入测试数据；</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> INSERT INTO table1(customer_id,city) VALUES(<span class="string">&#x27;163&#x27;</span>,<span class="string">&#x27;hangzhou&#x27;</span>);</span><br><span class="line"> INSERT INTO table1(customer_id,city) VALUES(<span class="string">&#x27;9you&#x27;</span>,<span class="string">&#x27;shanghai&#x27;</span>);</span><br><span class="line"> INSERT INTO table1(customer_id,city) VALUES(<span class="string">&#x27;tx&#x27;</span>,<span class="string">&#x27;hangzhou&#x27;</span>);</span><br><span class="line"> INSERT INTO table1(customer_id,city) VALUES(<span class="string">&#x27;baidu&#x27;</span>,<span class="string">&#x27;hangzhou&#x27;</span>);</span><br><span class="line"></span><br><span class="line"> INSERT INTO table2(customer_id) VALUES(<span class="string">&#x27;163&#x27;</span>);</span><br><span class="line"> INSERT INTO table2(customer_id) VALUES(<span class="string">&#x27;163&#x27;</span>);</span><br><span class="line"> INSERT INTO table2(customer_id) VALUES(<span class="string">&#x27;9you&#x27;</span>);</span><br><span class="line"> INSERT INTO table2(customer_id) VALUES(<span class="string">&#x27;9you&#x27;</span>);</span><br><span class="line"> INSERT INTO table2(customer_id) VALUES(<span class="string">&#x27;9you&#x27;</span>);</span><br><span class="line"> INSERT INTO table2(customer_id) VALUES(<span class="string">&#x27;tx&#x27;</span>);</span><br><span class="line"> INSERT INTO table2(customer_id) VALUES(NULL);</span><br><span class="line"></span><br><span class="line">准备工作做完以后，table1和table2看起来应该像下面这样：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> table1;</span><br><span class="line"> +-------------+----------+</span><br><span class="line"> | customer_id | city     |</span><br><span class="line"> +-------------+----------+</span><br><span class="line"> | <span class="number">163</span>         | hangzhou |</span><br><span class="line"> | 9you        | shanghai |</span><br><span class="line"> | baidu       | hangzhou |</span><br><span class="line"> | tx          | hangzhou |</span><br><span class="line"> +-------------+----------+</span><br><span class="line"> <span class="number">4</span> rows <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"> mysql&gt; select * <span class="keyword">from</span> table2;</span><br><span class="line"> +----------+-------------+</span><br><span class="line"> | order_id | customer_id |</span><br><span class="line"> +----------+-------------+</span><br><span class="line"> |        <span class="number">1</span> | <span class="number">163</span>         |</span><br><span class="line"> |        <span class="number">2</span> | <span class="number">163</span>         |</span><br><span class="line"> |        <span class="number">3</span> | 9you        |</span><br><span class="line"> |        <span class="number">4</span> | 9you        |</span><br><span class="line"> |        <span class="number">5</span> | 9you        |</span><br><span class="line"> |        <span class="number">6</span> | tx          |</span><br><span class="line"> |        <span class="number">7</span> | NULL        |</span><br><span class="line"> +----------+-------------+</span><br><span class="line"> <span class="number">7</span> rows <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<h4 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT a.customer_id,COUNT(b.order_id) <span class="keyword">as</span> total_orders FROM TABLE1 <span class="keyword">as</span> a INNER JOIN table2 <span class="keyword">as</span> b on a.customer_id = b.customer_id WHERE a.city = <span class="string">&#x27;hangzhou&#x27;</span> GROUP BY a.customer_id HAVING COUNT(b.customer_id &lt; <span class="number">2</span>) ORDER BY total_orders  desc;</span><br></pre></td></tr></table></figure>

<h4 id="单表查询的语法"><a href="#单表查询的语法" class="headerlink" title="单表查询的语法"></a>单表查询的语法</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT 字段<span class="number">1</span>,字段<span class="number">2.</span>.. FROM 表名</span><br><span class="line">                  WHERE 条件</span><br><span class="line">                  GROUP BY field</span><br><span class="line">                  HAVING 筛选</span><br><span class="line">                  ORDER BY field</span><br><span class="line">                  LIMIT 限制条数</span><br></pre></td></tr></table></figure>

<h4 id="关键字的执行优先级"><a href="#关键字的执行优先级" class="headerlink" title="关键字的执行优先级"></a>关键字的执行优先级</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">重点中的重点：关键字的执行优先级</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">where</span><br><span class="line">group by</span><br><span class="line">having</span><br><span class="line">select</span><br><span class="line">distinct</span><br><span class="line">order by</span><br><span class="line">limit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>找到表:<span class="keyword">from</span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>拿着where指定的约束条件，去文件/表中取出一条条记录</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>将取出的一条条记录进行分组group by，如果没有group by，则整体作为一组</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>将分组的结果进行having过滤</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>执行select</span><br><span class="line"></span><br><span class="line"><span class="number">6.</span>去重</span><br><span class="line"></span><br><span class="line"><span class="number">7.</span>将结果按条件排序：order by</span><br><span class="line"></span><br><span class="line"><span class="number">8.</span>限制结果的显示条数</span><br></pre></td></tr></table></figure>

<h4 id="单表查询练习"><a href="#单表查询练习" class="headerlink" title="单表查询练习"></a>单表查询练习</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1</span></span><br><span class="line">CREATE TABLE employee (</span><br><span class="line">	<span class="built_in">id</span> INT NOT NULL UNIQUE auto_increment,</span><br><span class="line">	NAME VARCHAR ( <span class="number">20</span> ) NOT NULL,</span><br><span class="line">	sex enum ( <span class="string">&#x27;male&#x27;</span>, <span class="string">&#x27;female&#x27;</span> ) NOT NULL DEFAULT <span class="string">&#x27;male&#x27;</span>,<span class="comment">#大部分是男的</span></span><br><span class="line">	age INT ( <span class="number">3</span> ) UNSIGNED NOT NULL DEFAULT <span class="number">28</span>,</span><br><span class="line">	hire_date date NOT NULL,</span><br><span class="line">	post VARCHAR ( <span class="number">50</span> ),</span><br><span class="line">	post_comment VARCHAR ( <span class="number">100</span> ),</span><br><span class="line">	salary DOUBLE ( <span class="number">15</span>, <span class="number">2</span> ),</span><br><span class="line">	office INT,<span class="comment">#一个部门一个屋子</span></span><br><span class="line">	depart_id INT </span><br><span class="line">);</span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line">desc employee;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 </span></span><br><span class="line"><span class="comment">#插入记录</span></span><br><span class="line"><span class="comment">#三个部门：教学，销售，运营</span></span><br><span class="line">insert into employee(name,sex,age,hire_date,post,salary,office,depart_id) values</span><br><span class="line">(<span class="string">&#x27;egon&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;20170301&#x27;</span>,<span class="string">&#x27;老男孩驻沙河办事处外交大使&#x27;</span>,<span class="number">7300.33</span>,<span class="number">401</span>,<span class="number">1</span>), <span class="comment">#以下是教学部</span></span><br><span class="line">(<span class="string">&#x27;alex&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">78</span>,<span class="string">&#x27;20150302&#x27;</span>,<span class="string">&#x27;teacher&#x27;</span>,<span class="number">1000000.31</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;wupeiqi&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">81</span>,<span class="string">&#x27;20130305&#x27;</span>,<span class="string">&#x27;teacher&#x27;</span>,<span class="number">8300</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;yuanhao&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">73</span>,<span class="string">&#x27;20140701&#x27;</span>,<span class="string">&#x27;teacher&#x27;</span>,<span class="number">3500</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;liwenzhou&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">28</span>,<span class="string">&#x27;20121101&#x27;</span>,<span class="string">&#x27;teacher&#x27;</span>,<span class="number">2100</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;jingliyang&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;20110211&#x27;</span>,<span class="string">&#x27;teacher&#x27;</span>,<span class="number">9000</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;jinxin&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;19000301&#x27;</span>,<span class="string">&#x27;teacher&#x27;</span>,<span class="number">30000</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;成龙&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">48</span>,<span class="string">&#x27;20101111&#x27;</span>,<span class="string">&#x27;teacher&#x27;</span>,<span class="number">10000</span>,<span class="number">401</span>,<span class="number">1</span>),</span><br><span class="line"></span><br><span class="line">(<span class="string">&#x27;歪歪&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">48</span>,<span class="string">&#x27;20150311&#x27;</span>,<span class="string">&#x27;sale&#x27;</span>,<span class="number">3000.13</span>,<span class="number">402</span>,<span class="number">2</span>),<span class="comment">#以下是销售部门</span></span><br><span class="line">(<span class="string">&#x27;丫丫&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">38</span>,<span class="string">&#x27;20101101&#x27;</span>,<span class="string">&#x27;sale&#x27;</span>,<span class="number">2000.35</span>,<span class="number">402</span>,<span class="number">2</span>),</span><br><span class="line">(<span class="string">&#x27;丁丁&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;20110312&#x27;</span>,<span class="string">&#x27;sale&#x27;</span>,<span class="number">1000.37</span>,<span class="number">402</span>,<span class="number">2</span>),</span><br><span class="line">(<span class="string">&#x27;星星&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;20160513&#x27;</span>,<span class="string">&#x27;sale&#x27;</span>,<span class="number">3000.29</span>,<span class="number">402</span>,<span class="number">2</span>),</span><br><span class="line">(<span class="string">&#x27;格格&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">28</span>,<span class="string">&#x27;20170127&#x27;</span>,<span class="string">&#x27;sale&#x27;</span>,<span class="number">4000.33</span>,<span class="number">402</span>,<span class="number">2</span>),</span><br><span class="line"></span><br><span class="line">(<span class="string">&#x27;张野&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">28</span>,<span class="string">&#x27;20160311&#x27;</span>,<span class="string">&#x27;operation&#x27;</span>,<span class="number">10000.13</span>,<span class="number">403</span>,<span class="number">3</span>), <span class="comment">#以下是运营部门</span></span><br><span class="line">(<span class="string">&#x27;程咬金&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;19970312&#x27;</span>,<span class="string">&#x27;operation&#x27;</span>,<span class="number">20000</span>,<span class="number">403</span>,<span class="number">3</span>),</span><br><span class="line">(<span class="string">&#x27;程咬银&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;20130311&#x27;</span>,<span class="string">&#x27;operation&#x27;</span>,<span class="number">19000</span>,<span class="number">403</span>,<span class="number">3</span>),</span><br><span class="line">(<span class="string">&#x27;程咬铜&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;20150411&#x27;</span>,<span class="string">&#x27;operation&#x27;</span>,<span class="number">18000</span>,<span class="number">403</span>,<span class="number">3</span>),</span><br><span class="line">(<span class="string">&#x27;程咬铁&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;20140512&#x27;</span>,<span class="string">&#x27;operation&#x27;</span>,<span class="number">17000</span>,<span class="number">403</span>,<span class="number">3</span>)</span><br><span class="line">;</span><br><span class="line"></span><br><span class="line"><span class="comment">#ps：如果在windows系统中，插入中文字符，select的结果为空白，可以将所有字符编码统一设置成gbk</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> 查出所有员工的名字，薪资,格式为</span><br><span class="line">    &lt;名字:egon&gt;    &lt;薪资:<span class="number">3000</span>&gt;</span><br><span class="line"><span class="number">2</span> 查出所有的岗位（去掉重复）</span><br><span class="line"><span class="number">3</span> 查出所有员工名字，以及他们的年薪,年薪的字段名为annual_year</span><br><span class="line"></span><br><span class="line">select concat(<span class="string">&#x27;&lt;名字:&#x27;</span>,name,<span class="string">&#x27;&gt;    &#x27;</span>,<span class="string">&#x27;&lt;薪资:&#x27;</span>,salary,<span class="string">&#x27;&gt;&#x27;</span>) <span class="keyword">from</span> employee;</span><br><span class="line">select distinct depart_id <span class="keyword">from</span> employee;</span><br><span class="line">select name,salary*<span class="number">12</span> annual_salary <span class="keyword">from</span> employee;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">. 查看岗位是teacher的员工姓名、年龄</span><br><span class="line">select name,age <span class="keyword">from</span> employee where post = <span class="string">&#x27;teacher&#x27;</span>;</span><br><span class="line"></span><br><span class="line">. 查看岗位是teacher且年龄大于<span class="number">30</span>岁的员工姓名、年龄</span><br><span class="line">select name,age <span class="keyword">from</span> employee where post=<span class="string">&#x27;teacher&#x27;</span> <span class="keyword">and</span> age &gt; <span class="number">30</span>; </span><br><span class="line">. 查看岗位是teacher且薪资在<span class="number">9000</span>-<span class="number">1000</span>范围内的员工姓名、年龄、薪资</span><br><span class="line">select name,age,salary <span class="keyword">from</span> employee where post=<span class="string">&#x27;teacher&#x27;</span> <span class="keyword">and</span> salary between <span class="number">9000</span> <span class="keyword">and</span> <span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">. 查看岗位描述不为NULL的员工信息</span><br><span class="line">select * <span class="keyword">from</span> employee where post_comment <span class="keyword">is</span> <span class="keyword">not</span> null;</span><br><span class="line"></span><br><span class="line">. 查看岗位是teacher且薪资是<span class="number">10000</span>或<span class="number">9000</span>或<span class="number">30000</span>的员工姓名、年龄、薪资</span><br><span class="line">select name,age,salary <span class="keyword">from</span> employee where post=<span class="string">&#x27;teacher&#x27;</span> <span class="keyword">and</span> salary <span class="keyword">in</span> (<span class="number">10000</span>,<span class="number">9000</span>,<span class="number">30000</span>);</span><br><span class="line"></span><br><span class="line">. 查看岗位是teacher且薪资不是<span class="number">10000</span>或<span class="number">9000</span>或<span class="number">30000</span>的员工姓名、年龄、薪资</span><br><span class="line">select name,age,salary <span class="keyword">from</span> employee where post=<span class="string">&#x27;teacher&#x27;</span> <span class="keyword">and</span> salary <span class="keyword">not</span> <span class="keyword">in</span> (<span class="number">10000</span>,<span class="number">9000</span>,<span class="number">30000</span>);</span><br><span class="line"></span><br><span class="line">. 查看岗位是teacher且名字是jin开头的员工姓名、年薪</span><br><span class="line">select name,salary*<span class="number">12</span> <span class="keyword">from</span> employee where post=<span class="string">&#x27;teacher&#x27;</span> <span class="keyword">and</span> name like <span class="string">&#x27;jin%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="分组查询group-by"><a href="#分组查询group-by" class="headerlink" title="分组查询group_by"></a>分组查询group_by</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一 什么是分组？为什么要分组？</span></span><br><span class="line"><span class="comment">#1、首先明确一点：分组发生在where之后，即分组是基于where之后得到的记录而进行的</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2、分组指的是：将所有记录按照某个相同字段进行归类，比如针对员工信息表的职位分组，或者按照性别进行分组等</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3、为何要分组呢？</span></span><br><span class="line">    取每个部门的最高工资</span><br><span class="line">    取每个部门的员工数</span><br><span class="line">    取男人数和女人数</span><br><span class="line"></span><br><span class="line">小窍门：‘每’这个字后面的字段，就是我们分组的依据</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#4、大前提：</span></span><br><span class="line">    可以按照任意字段分组，但是分组完毕后，比如group by post，只能查看post字段，如果想查看组内信息，需要借助于聚合函数</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment"># ONLY_FULL_GROUP_BY</span></span><br><span class="line"><span class="comment">#查看MySQL 5.7默认的sql_mode如下：</span></span><br><span class="line">mysql&gt; select @@<span class="keyword">global</span>.sql_mode;</span><br><span class="line">ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION</span><br><span class="line"></span><br><span class="line"><span class="comment">#！！！注意</span></span><br><span class="line">ONLY_FULL_GROUP_BY的语义就是确定select target <span class="built_in">list</span>中的所有列的值都是明确语义，简单的说来，在ONLY_FULL_GROUP_BY模式下，target <span class="built_in">list</span>中的值要么是来自于聚集函数的结果，要么是来自于group by <span class="built_in">list</span>中的表达式的值。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置sql_mole如下操作(我们可以去掉ONLY_FULL_GROUP_BY模式)：</span></span><br><span class="line">mysql&gt; <span class="built_in">set</span> <span class="keyword">global</span> sql_mode=<span class="string">&#x27;STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&#x27;</span>;</span><br><span class="line"></span><br><span class="line">！！！SQL_MODE设置！！！</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select @@<span class="keyword">global</span>.sql_mode;</span><br><span class="line">+-------------------+</span><br><span class="line">| @@<span class="keyword">global</span>.sql_mode |</span><br><span class="line">+-------------------+</span><br><span class="line">|                   |</span><br><span class="line">+-------------------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> emp group by post; </span><br><span class="line">+----+------+--------+-----+------------+----------------------------+--------------+------------+--------+-----------+</span><br><span class="line">| <span class="built_in">id</span> | name | sex    | age | hire_date  | post                       | post_comment | salary     | office | depart_id |</span><br><span class="line">+----+------+--------+-----+------------+----------------------------+--------------+------------+--------+-----------+</span><br><span class="line">| <span class="number">14</span> | 张野 | male   |  <span class="number">28</span> | <span class="number">2016</span>-03-<span class="number">11</span> | operation                  | NULL         |   <span class="number">10000.13</span> |    <span class="number">403</span> |         <span class="number">3</span> |</span><br><span class="line">|  <span class="number">9</span> | 歪歪 | female |  <span class="number">48</span> | <span class="number">2015</span>-03-<span class="number">11</span> | sale                       | NULL         |    <span class="number">3000.13</span> |    <span class="number">402</span> |         <span class="number">2</span> |</span><br><span class="line">|  <span class="number">2</span> | alex | male   |  <span class="number">78</span> | <span class="number">2015</span>-03-02 | teacher                    | NULL         | <span class="number">1000000.31</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">|  <span class="number">1</span> | egon | male   |  <span class="number">18</span> | <span class="number">2017</span>-03-01 | 老男孩驻沙河办事处外交大使 | NULL         |    <span class="number">7300.33</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">+----+------+--------+-----+------------+----------------------------+--------------+------------+--------+-----------+</span><br><span class="line"><span class="number">4</span> rows <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#由于没有设置ONLY_FULL_GROUP_BY,于是也可以有结果，默认都是组内的第一条记录，但其实这是没有意义的</span></span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="built_in">set</span> <span class="keyword">global</span> sql_mode=<span class="string">&#x27;ONLY_FULL_GROUP_BY&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; quit <span class="comment">#设置成功后，一定要退出，然后重新登录方可生效</span></span><br><span class="line">Bye</span><br><span class="line"></span><br><span class="line">mysql&gt; use db1;</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> emp group by post; <span class="comment">#报错</span></span><br><span class="line">ERROR <span class="number">1055</span> (<span class="number">42000</span>): <span class="string">&#x27;db1.emp.id&#x27;</span> isn<span class="string">&#x27;t in GROUP BY</span></span><br><span class="line"><span class="string">mysql&gt; select post,count(id) from emp group by post; #只能查看分组依据和使用聚合函数</span></span><br><span class="line"><span class="string">+----------------------------+-----------+</span></span><br><span class="line"><span class="string">| post                       | count(id) |</span></span><br><span class="line"><span class="string">+----------------------------+-----------+</span></span><br><span class="line"><span class="string">| operation                  |         5 |</span></span><br><span class="line"><span class="string">| sale                       |         5 |</span></span><br><span class="line"><span class="string">| teacher                    |         7 |</span></span><br><span class="line"><span class="string">| 老男孩驻沙河办事处外交大使 |         1 |</span></span><br><span class="line"><span class="string">+----------------------------+-----------+</span></span><br><span class="line"><span class="string">4 rows in set (0.00 sec)</span></span><br></pre></td></tr></table></figure>

<p>group_by</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">单独使用GROUP BY关键字分组</span><br><span class="line">    SELECT post FROM employee GROUP BY post;</span><br><span class="line">    注意：我们按照post字段分组，那么select查询的字段只能是post，想要获取组内的其他相关信息，需要借助函数</span><br><span class="line"></span><br><span class="line">GROUP BY关键字和GROUP_CONCAT()函数一起使用</span><br><span class="line">    SELECT post,GROUP_CONCAT(name) FROM employee GROUP BY post;<span class="comment">#按照岗位分组，并查看组内成员名</span></span><br><span class="line">    SELECT post,GROUP_CONCAT(name) <span class="keyword">as</span> emp_members FROM employee GROUP BY post;</span><br><span class="line"></span><br><span class="line">GROUP BY与聚合函数一起使用</span><br><span class="line">    select post,count(<span class="built_in">id</span>) <span class="keyword">as</span> count <span class="keyword">from</span> employee group by post;<span class="comment">#按照岗位分组，并查看每个组有多少人</span></span><br></pre></td></tr></table></figure>

<h4 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- SELECT COUNT(*) FROM employee; <span class="comment"># 统计表中共有多少条数据</span></span><br><span class="line">SELECT COUNT(*) FROM employee WHERE depart_id=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">SELECT <span class="built_in">max</span>(salary) FROM employee;</span><br><span class="line">SELECT <span class="built_in">min</span>(salary) FROM employee;</span><br><span class="line">SELECT avg(salary) FROM employee;</span><br><span class="line">SELECT <span class="built_in">sum</span>(salary) FROM employee;</span><br><span class="line">SELECT SUM(salary) FROM employee WHERE depart_id=<span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<p>练习</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 查询岗位名以及岗位包含的所有员工名字</span><br><span class="line"><span class="number">2.</span> 查询岗位名以及各岗位内包含的员工个数</span><br><span class="line"><span class="number">3.</span> 查询公司内男员工和女员工的个数</span><br><span class="line"><span class="number">4.</span> 查询岗位名以及各岗位的平均薪资</span><br><span class="line"><span class="number">5.</span> 查询岗位名以及各岗位的最高薪资</span><br><span class="line"><span class="number">6.</span> 查询岗位名以及各岗位的最低薪资</span><br><span class="line"><span class="number">7.</span> 查询男员工与男员工的平均薪资，女员工与女员工的平均薪资</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select post,group_concat(name) <span class="keyword">from</span> employee group by post;</span><br><span class="line">SELECT post, count(<span class="built_in">id</span>) FROM employee GROUP BY post;</span><br><span class="line">SELECT sex,count(<span class="built_in">id</span>) FROM employee GROUP BY sex;</span><br><span class="line">SELECT	post,avg(salary) FROM	employee GROUP BY post;</span><br><span class="line">SELECT	post,<span class="built_in">max</span>(salary) FROM	employee GROUP BY post;</span><br><span class="line">SELECT	post,<span class="built_in">min</span>(salary) FROM	employee GROUP BY post;</span><br><span class="line">SELECT sex,avg(salary) FROM employee GROUP BY sex;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="having过滤"><a href="#having过滤" class="headerlink" title="having过滤"></a>having过滤</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#！！！执行优先级从高到低：where &gt; group by &gt; having </span></span><br><span class="line"><span class="comment">#1. Where 发生在分组group by之前，因而Where中可以有任意字段，但是绝对不能使用聚合函数。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2. Having发生在分组group by之后，因而Having中可以使用分组的字段，无法直接取到其他字段,可以使用聚合函数</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select @@sql_mode;</span><br><span class="line">+--------------------+</span><br><span class="line">| @@sql_mode         |</span><br><span class="line">+--------------------+</span><br><span class="line">| ONLY_FULL_GROUP_BY |</span><br><span class="line">+--------------------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> employee where salary &gt; <span class="number">100000</span>;</span><br><span class="line">+----+------+------+-----+------------+---------+--------------+------------+--------+-----------+</span><br><span class="line">| <span class="built_in">id</span> | name | sex  | age | hire_date  | post    | post_comment | salary     | office | depart_id |</span><br><span class="line">+----+------+------+-----+------------+---------+--------------+------------+--------+-----------+</span><br><span class="line">|  <span class="number">2</span> | alex | male |  <span class="number">78</span> | <span class="number">2015</span>-03-02 | teacher | NULL         | <span class="number">1000000.31</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">+----+------+------+-----+------------+---------+--------------+------------+--------+-----------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> employee having salary &gt; <span class="number">100000</span>;</span><br><span class="line">ERROR <span class="number">1463</span> (<span class="number">42000</span>): Non-grouping field <span class="string">&#x27;salary&#x27;</span> <span class="keyword">is</span> used <span class="keyword">in</span> HAVING clause</span><br><span class="line"></span><br><span class="line">mysql&gt; select post,group_concat(name) <span class="keyword">from</span> employee group by post having salary &gt; <span class="number">10000</span>;<span class="comment">#错误，分组后无法直接取到salary字段</span></span><br><span class="line">ERROR <span class="number">1054</span> (42S22): Unknown column <span class="string">&#x27;salary&#x27;</span> <span class="keyword">in</span> <span class="string">&#x27;having clause&#x27;</span></span><br><span class="line">mysql&gt; select post,group_concat(name) <span class="keyword">from</span> employee group by post having avg(salary) &gt; <span class="number">10000</span>;</span><br><span class="line">+-----------+-------------------------------------------------------+</span><br><span class="line">| post | group_concat(name) |</span><br><span class="line">+-----------+-------------------------------------------------------+</span><br><span class="line">| operation | 程咬铁,程咬铜,程咬银,程咬金,张野 |</span><br><span class="line">| teacher | 成龙,jinxin,jingliyang,liwenzhou,yuanhao,wupeiqi,alex |</span><br><span class="line">+-----------+-------------------------------------------------------+</span><br><span class="line"><span class="number">2</span> rows <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">验证</span><br></pre></td></tr></table></figure>

<p>练习</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">1.</span> 查询各岗位内包含的员工个数小于<span class="number">3</span>的岗位名、岗位内包含员工名字、个数</span><br><span class="line"></span><br><span class="line">SELECT post,GROUP_CONCAT(name),count(<span class="built_in">id</span>) FROM employee GROUP BY post HAVING count(<span class="built_in">id</span>) &lt; <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 查询各岗位平均薪资大于<span class="number">10000</span>的岗位名、平均工资</span><br><span class="line"></span><br><span class="line">SELECT post ,avg(salary) FROM employee GROUP BY post HAVING avg(salary)&gt;<span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> 查询各岗位平均薪资大于<span class="number">10000</span>且小于<span class="number">20000</span>的岗位名、平均工资</span><br><span class="line">SELECT post ,avg(salary) FROM employee GROUP BY post HAVING avg(salary)&gt;<span class="number">10000</span> <span class="keyword">and</span> avg(salary)&lt;<span class="number">20000</span>;</span><br></pre></td></tr></table></figure>

<h4 id="查询排序-ORDER-BY"><a href="#查询排序-ORDER-BY" class="headerlink" title="查询排序:ORDER BY"></a>查询排序:ORDER BY</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">按单列排序</span><br><span class="line">    SELECT * FROM employee ORDER BY salary;</span><br><span class="line">    SELECT * FROM employee ORDER BY salary ASC; <span class="comment"># 升序  从小到大</span></span><br><span class="line">    SELECT * FROM employee ORDER BY salary DESC;<span class="comment"># 降序  从大到小</span></span><br><span class="line"></span><br><span class="line">按多列排序:先按照age排序，如果年纪相同，则按照薪资排序</span><br><span class="line">    SELECT * <span class="keyword">from</span> employee</span><br><span class="line">        ORDER BY age,</span><br><span class="line">        salary DESC;</span><br></pre></td></tr></table></figure>

<p>练习</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 查询所有员工信息，先按照age升序排序，如果age相同则按照hire_date降序排序</span><br><span class="line">select * <span class="keyword">from</span> employee ORDER BY age asc,hire_date desc;</span><br><span class="line"><span class="number">2.</span> 查询各岗位平均薪资大于<span class="number">10000</span>的岗位名、平均工资,结果按平均薪资升序排列</span><br><span class="line">SELECT post,avg(salary) FROM employee GROUP BY post HAVING avg(salary) &gt; <span class="number">10000</span> ORDER BY avg(salary) ASC;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 查询各岗位平均薪资大于<span class="number">10000</span>的岗位名、平均工资,结果按平均薪资降序排列</span><br><span class="line">SELECT post,avg(salary) FROM employee GROUP BY post HAVING avg(salary) &gt; <span class="number">10000</span> ORDER BY avg(salary) DESC;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="限制查询的记录数-LIMIT"><a href="#限制查询的记录数-LIMIT" class="headerlink" title="限制查询的记录数:LIMIT"></a>限制查询的记录数:LIMIT</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">示例：</span><br><span class="line">    SELECT * FROM employee ORDER BY salary DESC </span><br><span class="line">        LIMIT <span class="number">3</span>;                    <span class="comment">#默认初始位置为0 </span></span><br><span class="line">    </span><br><span class="line">    SELECT * FROM employee ORDER BY salary DESC</span><br><span class="line">        LIMIT <span class="number">0</span>,<span class="number">5</span>; <span class="comment">#从第0开始，即先查询出第一条，然后包含这一条在内往后查5条</span></span><br><span class="line"></span><br><span class="line">    SELECT * FROM employee ORDER BY salary DESC</span><br><span class="line">        LIMIT <span class="number">5</span>,<span class="number">5</span>; <span class="comment">#从第5开始，即先查询出第6条，然后包含这一条在内往后查5条</span></span><br></pre></td></tr></table></figure>

<h4 id="使用正则表达式查询"><a href="#使用正则表达式查询" class="headerlink" title="使用正则表达式查询"></a>使用正则表达式查询</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM employee WHERE name REGEXP <span class="string">&#x27;^ale&#x27;</span>;</span><br><span class="line"></span><br><span class="line">SELECT * FROM employee WHERE name REGEXP <span class="string">&#x27;on$&#x27;</span>;</span><br><span class="line"></span><br><span class="line">SELECT * FROM employee WHERE name REGEXP <span class="string">&#x27;m&#123;2&#125;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">小结：对字符串匹配的方式</span><br><span class="line">WHERE name = <span class="string">&#x27;egon&#x27;</span>;</span><br><span class="line">WHERE name LIKE <span class="string">&#x27;yua%&#x27;</span>;</span><br><span class="line">WHERE name REGEXP <span class="string">&#x27;on$&#x27;</span>;</span><br><span class="line"></span><br><span class="line">查看所有员工中名字是jin开头，n或者g结果的员工信息</span><br><span class="line">SELECT * FROM employee WHERE name REGEXP <span class="string">&#x27;^jin&#x27;</span> <span class="keyword">or</span> <span class="string">&#x27;^n&#x27;</span> <span class="keyword">or</span> <span class="string">&#x27;^g&#x27;</span>;</span><br><span class="line"></span><br><span class="line">SELECT * FROM employee WHERE name REGEXP <span class="keyword">in</span> (<span class="string">&#x27;^jin&#x27;</span>,<span class="string">&#x27;^n&#x27;</span>,<span class="string">&#x27;^g&#x27;</span>);</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> employee where name regexp <span class="string">&#x27;^jin.*[gn]$&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="数据备份"><a href="#数据备份" class="headerlink" title="数据备份"></a>数据备份</h1><h3 id="MySQL数据备份"><a href="#MySQL数据备份" class="headerlink" title="MySQL数据备份"></a>MySQL数据备份</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1. 物理备份： 直接复制数据库文件，适用于大型数据库环境。但不能恢复到异构系统中如Windows。</span></span><br><span class="line"><span class="comment">#2. 逻辑备份： 备份的是建表、建库、插入等操作所执行SQL语句，适用于中小型数据库，效率相对较低。</span></span><br><span class="line"><span class="comment">#3. 导出表： 将表导入到文本文件中。 </span></span><br></pre></td></tr></table></figure>

<h4 id="使用mysqldump实现逻辑备份"><a href="#使用mysqldump实现逻辑备份" class="headerlink" title="使用mysqldump实现逻辑备份"></a>使用mysqldump实现逻辑备份</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#语法：</span></span><br><span class="line"><span class="comment"># mysqldump -h 服务器 -u用户名 -p密码 数据库名 &gt; 备份文件.sql</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#示例：</span></span><br><span class="line"><span class="comment">#单库备份</span></span><br><span class="line">mysqldump -uroot -p123 db1 &gt; db1.sql</span><br><span class="line">mysqldump -uroot -p123 db1 table1 table2 &gt; db1-table1-table2.sql</span><br><span class="line"></span><br><span class="line"><span class="comment">#多库备份</span></span><br><span class="line">mysqldump -uroot -p123 --databases db1 db2 mysql db3 &gt; db1_db2_mysql_db3.sql</span><br><span class="line"></span><br><span class="line"><span class="comment">#备份所有库</span></span><br><span class="line">mysqldump -uroot -p123 --<span class="built_in">all</span>-databases &gt; <span class="built_in">all</span>.sql</span><br></pre></td></tr></table></figure>

<h4 id="恢复逻辑备份"><a href="#恢复逻辑备份" class="headerlink" title="恢复逻辑备份"></a>恢复逻辑备份</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#方法一：</span></span><br><span class="line">[root@egon backup]<span class="comment"># mysql -uroot -p123 &lt; /backup/all.sql</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#方法二：</span></span><br><span class="line">mysql&gt; use db1;</span><br><span class="line">mysql&gt; SET SQL_LOG_BIN=<span class="number">0</span>;</span><br><span class="line">mysql&gt; source /root/db1.sql</span><br><span class="line"></span><br><span class="line"><span class="comment">#注：如果备份/恢复单个库时，可以修改sql文件</span></span><br><span class="line">DROP database <span class="keyword">if</span> exists school;</span><br><span class="line">create database school;</span><br><span class="line">use school;</span><br></pre></td></tr></table></figure>

<h4 id="备份-恢复案例"><a href="#备份-恢复案例" class="headerlink" title="备份/恢复案例"></a><strong>备份/恢复案例</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据库备份/恢复实验一：数据库损坏</span></span><br><span class="line">备份：</span><br><span class="line"><span class="number">1.</span> <span class="comment"># mysqldump -uroot -p123 --all-databases &gt; /backup/`date +%F`_all.sql</span></span><br><span class="line"><span class="number">2.</span> <span class="comment"># mysql -uroot -p123 -e &#x27;flush logs&#x27; //截断并产生新的binlog</span></span><br><span class="line"><span class="number">3.</span> 插入数据 //模拟服务器正常运行</span><br><span class="line"><span class="number">4.</span> mysql&gt; <span class="built_in">set</span> sql_log_bin=<span class="number">0</span>; //模拟服务器损坏</span><br><span class="line">mysql&gt; drop database db;</span><br><span class="line"></span><br><span class="line">恢复：</span><br><span class="line"><span class="number">1.</span> <span class="comment"># mysqlbinlog 最后一个binlog &gt; /backup/last_bin.log</span></span><br><span class="line"><span class="number">2.</span> mysql&gt; <span class="built_in">set</span> sql_log_bin=<span class="number">0</span>; </span><br><span class="line">mysql&gt; source /backup/<span class="number">2014</span>-02-13_<span class="built_in">all</span>.sql //恢复最近一次完全备份 </span><br><span class="line">mysql&gt; source /backup/last_bin.log //恢复最后个binlog文件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#数据库备份/恢复实验二：如果有误删除</span></span><br><span class="line">备份：</span><br><span class="line"><span class="number">1.</span> mysqldump -uroot -p123 --<span class="built_in">all</span>-databases &gt; /backup/`date +%F`_<span class="built_in">all</span>.sql</span><br><span class="line"><span class="number">2.</span> mysql -uroot -p123 -e <span class="string">&#x27;flush logs&#x27;</span> //截断并产生新的binlog</span><br><span class="line"><span class="number">3.</span> 插入数据 //模拟服务器正常运行</span><br><span class="line"><span class="number">4.</span> drop table db1.t1 //模拟误删除</span><br><span class="line"><span class="number">5.</span> 插入数据 //模拟服务器正常运行</span><br><span class="line"></span><br><span class="line">恢复：</span><br><span class="line"><span class="number">1.</span> <span class="comment"># mysqlbinlog 最后一个binlog --stop-position=260 &gt; /tmp/1.sql </span></span><br><span class="line"><span class="comment"># mysqlbinlog 最后一个binlog --start-position=900 &gt; /tmp/2.sql </span></span><br><span class="line"><span class="number">2.</span> mysql&gt; <span class="built_in">set</span> sql_log_bin=<span class="number">0</span>; </span><br><span class="line">mysql&gt; source /backup/<span class="number">2014</span>-02-13_<span class="built_in">all</span>.sql //恢复最近一次完全备份</span><br><span class="line">mysql&gt; source /tmp/<span class="number">1.</span>log //恢复最后个binlog文件</span><br><span class="line">mysql&gt; source /tmp/<span class="number">2.</span>log //恢复最后个binlog文件</span><br><span class="line"></span><br><span class="line">注意事项：</span><br><span class="line"><span class="number">1.</span> 完全恢复到一个干净的环境（例如新的数据库或删除原有的数据库）</span><br><span class="line"><span class="number">2.</span> 恢复期间所有SQL语句不应该记录到binlog中</span><br></pre></td></tr></table></figure>

<h4 id="实现自动化备份"><a href="#实现自动化备份" class="headerlink" title="实现自动化备份"></a>实现自动化备份</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">备份计划：</span><br><span class="line"><span class="number">1.</span> 什么时间 <span class="number">2</span>:<span class="number">00</span></span><br><span class="line"><span class="number">2.</span> 对哪些数据库备份</span><br><span class="line"><span class="number">3.</span> 备份文件放的位置</span><br><span class="line"></span><br><span class="line">备份脚本：</span><br><span class="line">[root@egon ~]<span class="comment"># vim /mysql_back.sql</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">back_dir=/backup</span><br><span class="line">back_file=`date +%F`_<span class="built_in">all</span>.sql</span><br><span class="line">user=root</span><br><span class="line"><span class="keyword">pass</span>=<span class="number">123</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ ! -d /backup ];then</span><br><span class="line">mkdir -p /backup</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"><span class="comment"># 备份并截断日志</span></span><br><span class="line">mysqldump -u$&#123;user&#125; -p$&#123;<span class="keyword">pass</span>&#125; --events --<span class="built_in">all</span>-databases &gt; $&#123;back_dir&#125;/$&#123;back_file&#125;</span><br><span class="line">mysql -u$&#123;user&#125; -p$&#123;<span class="keyword">pass</span>&#125; -e <span class="string">&#x27;flush logs&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 只保留最近一周的备份</span></span><br><span class="line">cd $back_dir</span><br><span class="line">find . -mtime +<span class="number">7</span> -<span class="built_in">exec</span> rm -rf &#123;&#125; \;</span><br><span class="line"></span><br><span class="line">手动测试：</span><br><span class="line">[root@egon ~]<span class="comment"># chmod a+x /mysql_back.sql </span></span><br><span class="line">[root@egon ~]<span class="comment"># chattr +i /mysql_back.sql</span></span><br><span class="line">[root@egon ~]<span class="comment"># /mysql_back.sql</span></span><br><span class="line"></span><br><span class="line">配置cron：</span><br><span class="line">[root@egon ~]<span class="comment"># crontab -l</span></span><br><span class="line"><span class="number">2</span> * * * /mysql_back.sql</span><br></pre></td></tr></table></figure>

<h4 id="表的导出和导入"><a href="#表的导出和导入" class="headerlink" title="表的导出和导入"></a><strong>表的导出和导入</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">SELECT... INTO OUTFILE 导出文本文件</span><br><span class="line">示例：</span><br><span class="line">mysql&gt; SELECT * FROM school.student1</span><br><span class="line">INTO OUTFILE <span class="string">&#x27;student1.txt&#x27;</span></span><br><span class="line">FIELDS TERMINATED BY <span class="string">&#x27;,&#x27;</span> //定义字段分隔符</span><br><span class="line">OPTIONALLY ENCLOSED BY <span class="string">&#x27;”&#x27;</span> //定义字符串使用什么符号括起来</span><br><span class="line">LINES TERMINATED BY <span class="string">&#x27;\n&#x27;</span> ; //定义换行符</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql 命令导出文本文件</span><br><span class="line">示例:</span><br><span class="line"><span class="comment"># mysql -u root -p123 -e &#x27;select * from student1.school&#x27; &gt; /tmp/student1.txt</span></span><br><span class="line"><span class="comment"># mysql -u root -p123 --xml -e &#x27;select * from student1.school&#x27; &gt; /tmp/student1.xml</span></span><br><span class="line"><span class="comment"># mysql -u root -p123 --html -e &#x27;select * from student1.school&#x27; &gt; /tmp/student1.html</span></span><br><span class="line"></span><br><span class="line">LOAD DATA INFILE 导入文本文件</span><br><span class="line">mysql&gt; DELETE FROM student1;</span><br><span class="line">mysql&gt; LOAD DATA INFILE <span class="string">&#x27;/tmp/student1.txt&#x27;</span></span><br><span class="line">INTO TABLE school.student1</span><br><span class="line">FIELDS TERMINATED BY <span class="string">&#x27;,&#x27;</span></span><br><span class="line">OPTIONALLY ENCLOSED BY <span class="string">&#x27;”&#x27;</span></span><br><span class="line">LINES TERMINATED BY <span class="string">&#x27;\n&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#可能会报错</span></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> db1.emp into outfile <span class="string">&#x27;C:\\db1.emp.txt&#x27;</span> fields terminated by <span class="string">&#x27;,&#x27;</span> lines terminated by <span class="string">&#x27;\r\n&#x27;</span>;</span><br><span class="line">ERROR <span class="number">1238</span> (HY000): Variable <span class="string">&#x27;secure_file_priv&#x27;</span> <span class="keyword">is</span> a read only variable</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#数据库最关键的是数据，一旦数据库权限泄露，那么通过上述语句就可以轻松将数据导出到文件中然后下载拿走，因而mysql对此作了限制，只能将文件导出到指定目录</span></span><br><span class="line">在配置文件中</span><br><span class="line">[mysqld]</span><br><span class="line">secure_file_priv=<span class="string">&#x27;C:\\&#x27;</span> <span class="comment">#只能将数据导出到C:\\下</span></span><br><span class="line"></span><br><span class="line">重启mysql</span><br><span class="line">重新执行上述语句</span><br><span class="line"></span><br><span class="line">报错：Variable <span class="string">&#x27;secure_file_priv&#x27;</span> <span class="keyword">is</span> a read only</span><br></pre></td></tr></table></figure>



<h4 id="数据库迁移"><a href="#数据库迁移" class="headerlink" title="数据库迁移"></a>数据库迁移</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">务必保证在相同版本之间迁移</span><br><span class="line"><span class="comment"># mysqldump -h 源IP -uroot -p123 --databases db1 | mysql -h 目标IP -uroot -p456</span></span><br></pre></td></tr></table></figure>

<h4 id="sql注入解决"><a href="#sql注入解决" class="headerlink" title="sql注入解决"></a>sql注入解决</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 原来是我们对sql进行字符串拼接</span></span><br><span class="line"><span class="comment"># sql=&quot;select * from userinfo where name=&#x27;%s&#x27; and password=&#x27;%s&#x27;&quot; %(user,pwd)</span></span><br><span class="line"><span class="comment"># print(sql)</span></span><br><span class="line"><span class="comment"># res=cursor.execute(sql)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#改写为（execute帮我们做字符串拼接，我们无需且一定不能再为%s加引号了）</span></span><br><span class="line">sql=<span class="string">&quot;select * from userinfo where name=%s and password=%s&quot;</span> <span class="comment">#！！！注意%s需要去掉引号，因为pymysql会自动为我们加上</span></span><br><span class="line">res=cursor.execute(sql,[user,pwd]) <span class="comment">#pymysql模块自动帮我们解决sql注入的问题，只要我们按照pymysql的规矩来。</span></span><br></pre></td></tr></table></figure>

<h4 id="增、删、改：conn-commit"><a href="#增、删、改：conn-commit" class="headerlink" title="增、删、改：conn.commit()"></a><strong>增、删、改：conn.commit()</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="comment">#链接</span></span><br><span class="line">conn=pymysql.connect(host=<span class="string">&#x27;localhost&#x27;</span>,user=<span class="string">&#x27;root&#x27;</span>,password=<span class="string">&#x27;123&#x27;</span>,database=<span class="string">&#x27;egon&#x27;</span>)</span><br><span class="line"><span class="comment">#游标</span></span><br><span class="line">cursor=conn.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment">#执行sql语句</span></span><br><span class="line"><span class="comment">#part1</span></span><br><span class="line"><span class="comment"># sql=&#x27;insert into userinfo(name,password) values(&quot;root&quot;,&quot;123456&quot;);&#x27;</span></span><br><span class="line"><span class="comment"># res=cursor.execute(sql) #执行sql语句，返回sql影响成功的行数</span></span><br><span class="line"><span class="comment"># print(res)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#part2</span></span><br><span class="line"><span class="comment"># sql=&#x27;insert into userinfo(name,password) values(%s,%s);&#x27;</span></span><br><span class="line"><span class="comment"># res=cursor.execute(sql,(&quot;root&quot;,&quot;123456&quot;)) #执行sql语句，返回sql影响成功的行数</span></span><br><span class="line"><span class="comment"># print(res)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#part3</span></span><br><span class="line">sql=<span class="string">&#x27;insert into userinfo(name,password) values(%s,%s);&#x27;</span></span><br><span class="line">res=cursor.executemany(sql,[(<span class="string">&quot;root&quot;</span>,<span class="string">&quot;123456&quot;</span>),(<span class="string">&quot;lhf&quot;</span>,<span class="string">&quot;12356&quot;</span>),(<span class="string">&quot;eee&quot;</span>,<span class="string">&quot;156&quot;</span>)]) <span class="comment">#执行sql语句，返回sql影响成功的行数</span></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line">conn.commit() <span class="comment">#提交后才发现表中插入记录成功</span></span><br><span class="line">cursor.close()</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>

<h4 id="查：fetchone，fetchmany，fetchall"><a href="#查：fetchone，fetchmany，fetchall" class="headerlink" title="查：fetchone，fetchmany，fetchall"></a><strong>查：fetchone，fetchmany，fetchall</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="comment">#链接</span></span><br><span class="line">conn=pymysql.connect(host=<span class="string">&#x27;localhost&#x27;</span>,user=<span class="string">&#x27;root&#x27;</span>,password=<span class="string">&#x27;123&#x27;</span>,database=<span class="string">&#x27;egon&#x27;</span>)</span><br><span class="line"><span class="comment">#游标</span></span><br><span class="line">cursor=conn.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment">#执行sql语句</span></span><br><span class="line">sql=<span class="string">&#x27;select * from userinfo;&#x27;</span></span><br><span class="line">rows=cursor.execute(sql) <span class="comment">#执行sql语句，返回sql影响成功的行数rows,将结果放入一个集合，等待被查询</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cursor.scroll(3,mode=&#x27;absolute&#x27;) # 相对绝对位置移动</span></span><br><span class="line"><span class="comment"># cursor.scroll(3,mode=&#x27;relative&#x27;) # 相对当前位置移动</span></span><br><span class="line">res1=cursor.fetchone()</span><br><span class="line">res2=cursor.fetchone()</span><br><span class="line">res3=cursor.fetchone()</span><br><span class="line">res4=cursor.fetchmany(<span class="number">2</span>)</span><br><span class="line">res5=cursor.fetchall()</span><br><span class="line"><span class="built_in">print</span>(res1)</span><br><span class="line"><span class="built_in">print</span>(res2)</span><br><span class="line"><span class="built_in">print</span>(res3)</span><br><span class="line"><span class="built_in">print</span>(res4)</span><br><span class="line"><span class="built_in">print</span>(res5)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;%s rows in set (0.00 sec)&#x27;</span> %rows)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">conn.commit() <span class="comment">#提交后才发现表中插入记录成功</span></span><br><span class="line">cursor.close()</span><br><span class="line">conn.close()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">(1, &#x27;root&#x27;, &#x27;123456&#x27;)</span></span><br><span class="line"><span class="string">(2, &#x27;root&#x27;, &#x27;123456&#x27;)</span></span><br><span class="line"><span class="string">(3, &#x27;root&#x27;, &#x27;123456&#x27;)</span></span><br><span class="line"><span class="string">((4, &#x27;root&#x27;, &#x27;123456&#x27;), (5, &#x27;root&#x27;, &#x27;123456&#x27;))</span></span><br><span class="line"><span class="string">((6, &#x27;root&#x27;, &#x27;123456&#x27;), (7, &#x27;lhf&#x27;, &#x27;12356&#x27;), (8, &#x27;eee&#x27;, &#x27;156&#x27;))</span></span><br><span class="line"><span class="string">rows in set (0.00 sec)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="获取插入的最后一条数据的自增ID"><a href="#获取插入的最后一条数据的自增ID" class="headerlink" title="获取插入的最后一条数据的自增ID"></a><strong>获取插入的最后一条数据的自增ID</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line">conn=pymysql.connect(host=<span class="string">&#x27;localhost&#x27;</span>,user=<span class="string">&#x27;root&#x27;</span>,password=<span class="string">&#x27;123&#x27;</span>,database=<span class="string">&#x27;egon&#x27;</span>)</span><br><span class="line">cursor=conn.cursor()</span><br><span class="line"></span><br><span class="line">sql=<span class="string">&#x27;insert into userinfo(name,password) values(&quot;xxx&quot;,&quot;123&quot;);&#x27;</span></span><br><span class="line">rows=cursor.execute(sql)</span><br><span class="line"><span class="built_in">print</span>(cursor.lastrowid) <span class="comment">#在插入语句后查看</span></span><br><span class="line"></span><br><span class="line">conn.commit()</span><br><span class="line"></span><br><span class="line">cursor.close()</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>

<h1 id="SQL练习"><a href="#SQL练习" class="headerlink" title="SQL练习"></a>SQL练习</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、查询所有的课程的名称以及对应的任课老师姓名</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> course inner join teacher on course.teacher_id = teacher.tid;</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、查询学生表中男女生各有多少人</span><br><span class="line"></span><br><span class="line">SELECT gender,COUNT(<span class="number">1</span>) FROM student GROUP BY gender;</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、查询物理成绩等于<span class="number">100</span>的学生的姓名</span><br><span class="line">select sname <span class="keyword">from</span> student where sid <span class="keyword">in</span></span><br><span class="line">(select student_id <span class="keyword">from</span></span><br><span class="line"> score inner join course on course.cid = score.course_id </span><br><span class="line"> where course.cname = <span class="string">&#x27;物理&#x27;</span> <span class="keyword">and</span> num = <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、查询平均成绩大于八十分的同学的姓名和平均成绩</span><br><span class="line">select sname,t1.avg_num <span class="keyword">from</span> student inner join</span><br><span class="line">(select student_id,avg(num) <span class="keyword">as</span> avg_num </span><br><span class="line"> <span class="keyword">from</span> score group by student_id</span><br><span class="line"> having avg(num) &gt; <span class="number">80</span>) <span class="keyword">as</span> t1</span><br><span class="line">on student.sid = t1.student_id;</span><br><span class="line"><span class="number">5</span>、查询所有学生的学号，姓名，选课数，总成绩</span><br><span class="line">select student.sid,sname , t1.course_count, t1.sum_num</span><br><span class="line"><span class="keyword">from</span> student left join </span><br><span class="line">(select student_id,</span><br><span class="line"> count(course_id) <span class="keyword">as</span> course_count,</span><br><span class="line"> <span class="built_in">sum</span>(num) <span class="keyword">as</span> sum_num </span><br><span class="line"> <span class="keyword">from</span> score </span><br><span class="line"> group by student_id) <span class="keyword">as</span> t1</span><br><span class="line">on student.sid = t1.student_id;</span><br><span class="line"><span class="number">6</span>、 查询姓李老师的个数</span><br><span class="line">select count(tname) <span class="keyword">from</span> teacher where tname like <span class="string">&#x27;李%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">7</span>、 查询没有报李平老师课的学生姓名</span><br><span class="line"></span><br><span class="line">select sname <span class="keyword">from</span> student where sid <span class="keyword">not</span> <span class="keyword">in</span> (</span><br><span class="line">    select distinct student_id </span><br><span class="line"><span class="keyword">from</span> score</span><br><span class="line">    where course_id <span class="keyword">in</span> (</span><br><span class="line">   select course.cid <span class="keyword">from</span> course </span><br><span class="line">    inner join teacher on teacher.tid = course.teacher_id</span><br><span class="line">    where teacher.tname = <span class="string">&#x27;李平老师&#x27;</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="number">8</span>、 查询物理课程比生物课程高的学生的学号</span><br><span class="line">select t1.student_id <span class="keyword">from</span> </span><br><span class="line">(select student_id ,num <span class="keyword">from</span> score</span><br><span class="line">where course_id =(</span><br><span class="line">select cid <span class="keyword">from</span> course where course.cname = <span class="string">&#x27;物理&#x27;</span>)) <span class="keyword">as</span> t1</span><br><span class="line">inner join </span><br><span class="line">(select student_id ,num <span class="keyword">from</span> score</span><br><span class="line">where course_id =(</span><br><span class="line">select cid <span class="keyword">from</span> course where course.cname = <span class="string">&#x27;生物&#x27;</span>)) <span class="keyword">as</span> t2</span><br><span class="line">on t1.student_id = t2.student_id </span><br><span class="line">where t1.num &gt; t2.num;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">9</span>、 查询没有同时选修物理课程和体育课程的学生姓名</span><br><span class="line">select sname <span class="keyword">from</span> student where sid <span class="keyword">in</span> (</span><br><span class="line">    select  student_id</span><br><span class="line"><span class="keyword">from</span> score</span><br><span class="line">where </span><br><span class="line">    course_id <span class="keyword">in</span> (</span><br><span class="line">    select cid <span class="keyword">from</span> course </span><br><span class="line">        where </span><br><span class="line">        cname = <span class="string">&#x27;物理&#x27;</span> <span class="keyword">or</span> cname = <span class="string">&#x27;体育&#x27;</span>)</span><br><span class="line">    group by student_id </span><br><span class="line">    having count(course_id) = <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="number">10</span>、查询挂科超过两门(包括两门)的学生姓名和班级</span><br><span class="line"></span><br><span class="line">select sname,<span class="keyword">class</span>.caption <span class="keyword">from</span> student inner join(</span><br><span class="line">select student_id <span class="keyword">from</span> score</span><br><span class="line">where num &lt;<span class="number">60</span></span><br><span class="line">group by student_id </span><br><span class="line">    having</span><br><span class="line">count(course_id) &gt;= <span class="number">2</span>) <span class="keyword">as</span> t1 </span><br><span class="line">inner join <span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class"><span class="title">on</span> <span class="title">t1</span>.<span class="title">student_id</span> = <span class="title">student</span>.<span class="title">sid</span></span></span><br><span class="line"><span class="class"><span class="title">and</span> <span class="title">student</span>.<span class="title">class_id</span> = <span class="title">class</span>.<span class="title">cid</span>;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">11 、查询选修了所有课程的学生姓名</span></span><br><span class="line"><span class="class"><span class="title">select</span> <span class="title">sname</span> <span class="title">from</span> <span class="title">student</span> <span class="title">where</span> <span class="title">sid</span> <span class="title">in</span> (<span class="params">select student_id <span class="keyword">from</span> score group by student_id </span></span></span><br><span class="line"><span class="params"><span class="class">  having count(<span class="params">course_id</span>) = (<span class="params">select count(<span class="params">cid</span>) <span class="keyword">from</span> course</span>)</span>);</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">12、查询李平老师教的课程的所有成绩记录</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">select</span> * <span class="title">from</span> <span class="title">score</span> <span class="title">where</span> <span class="title">course_id</span> <span class="title">in</span> (<span class="params">select cid <span class="keyword">from</span> course inner join teacher on course.teacher_id = teacher.tid</span></span></span><br><span class="line"><span class="params"><span class="class">  where teacher.tname = <span class="string">&#x27;李平老师&#x27;</span></span>);</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">13、查询全部学生都选修了的课程号和课程名</span></span><br><span class="line"><span class="class"><span class="title">select</span> <span class="title">cid</span>,<span class="title">cname</span> <span class="title">from</span> <span class="title">course</span> <span class="title">where</span> <span class="title">cid</span> <span class="title">in</span> (<span class="params">select course_id <span class="keyword">from</span> score group by course_id</span></span></span><br><span class="line"><span class="params"><span class="class">   having </span></span></span><br><span class="line"><span class="params"><span class="class"> count(<span class="params">student_id</span>) = (<span class="params">select count(<span class="params">sid</span>) <span class="keyword">from</span> student</span>)                                      </span>);</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">14、查询每门课程被选修的次数</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">select</span> <span class="title">course_id</span>,<span class="title">count</span>(<span class="params">student_id</span>) <span class="title">from</span> <span class="title">score</span> <span class="title">group</span> <span class="title">by</span> <span class="title">course_id</span>;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">15、查询之选修了一门课程的学生姓名和学号</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">select</span> <span class="title">sname</span>,<span class="title">sid</span> <span class="title">from</span> <span class="title">student</span> <span class="title">where</span> <span class="title">sid</span> <span class="title">in</span> (<span class="params">select student_id <span class="keyword">from</span> score group by student_id</span></span></span><br><span class="line"><span class="params"><span class="class"> having count(<span class="params">course_id</span>) =<span class="number">1</span></span>);</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">16、查询所有学生考出的成绩并按从高到低排序（成绩去重）</span></span><br><span class="line"><span class="class"><span class="title">select</span> <span class="title">distinct</span> <span class="title">num</span> <span class="title">from</span> <span class="title">score</span> <span class="title">order</span> <span class="title">by</span> <span class="title">num</span> <span class="title">desc</span>;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">17、查询平均成绩大于85的学生姓名和平均成绩</span></span><br><span class="line"><span class="class"><span class="title">select</span> <span class="title">sname</span> ,<span class="title">t1</span>.<span class="title">avg_num</span> <span class="title">from</span> <span class="title">student</span> <span class="title">inner</span> <span class="title">join</span>(<span class="params">select student_id,avg(<span class="params">num</span>) <span class="keyword">as</span> avg_num <span class="keyword">from</span> score  group by student_id having avg(<span class="params">num</span>) &gt; <span class="number">85</span></span>) <span class="title">as</span> <span class="title">t1</span></span></span><br><span class="line"><span class="class"><span class="title">on</span> <span class="title">student</span>.<span class="title">sid</span> = <span class="title">t1</span>.<span class="title">student_id</span>;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">18、查询生物成绩不及格的学生姓名和对应生物分数</span></span><br><span class="line"><span class="class"><span class="title">select</span> <span class="title">sname</span>, <span class="title">num</span> <span class="title">from</span> </span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">19、查询在所有选修了李平老师课程的学生中，这些课程(<span class="params">李平老师的课程，不是所有课程</span>)平均成绩最高的学生姓名</span></span><br><span class="line"><span class="class"><span class="title">SELECT</span></span></span><br><span class="line"><span class="class">    <span class="title">student</span>.<span class="title">sname</span></span></span><br><span class="line"><span class="class"><span class="title">FROM</span></span></span><br><span class="line"><span class="class">    <span class="title">student</span></span></span><br><span class="line"><span class="class"><span class="title">WHERE</span></span></span><br><span class="line"><span class="class">    <span class="title">sid</span> = (<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="class">        SELECT </span></span></span><br><span class="line"><span class="params"><span class="class">            student_id</span></span></span><br><span class="line"><span class="params"><span class="class">        FROM</span></span></span><br><span class="line"><span class="params"><span class="class">            score</span></span></span><br><span class="line"><span class="params"><span class="class">        WHERE</span></span></span><br><span class="line"><span class="params"><span class="class">            course_id IN (<span class="params"></span></span></span></span><br><span class="line"><span class="params"><span class="params"><span class="class">                SELECT</span></span></span></span><br><span class="line"><span class="params"><span class="params"><span class="class">                    course.cid</span></span></span></span><br><span class="line"><span class="params"><span class="params"><span class="class">                FROM</span></span></span></span><br><span class="line"><span class="params"><span class="params"><span class="class">                    course</span></span></span></span><br><span class="line"><span class="params"><span class="params"><span class="class">                INNER JOIN teacher ON course.teacher_id = teacher.tid</span></span></span></span><br><span class="line"><span class="params"><span class="params"><span class="class">                WHERE</span></span></span></span><br><span class="line"><span class="params"><span class="params"><span class="class">                    teacher.tname = <span class="string">&#x27;李平老师&#x27;</span></span></span></span></span><br><span class="line"><span class="params"><span class="params"><span class="class">            </span>)group by student_id  order by avg(<span class="params">num</span>) desc limit <span class="number">1</span></span></span></span><br><span class="line"><span class="params"><span class="class">    </span>) ;</span></span><br><span class="line"><span class="class"> </span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">20、查询每门课程成绩最好的前两名学生姓名</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">21、查询不同课程但成绩相同的学号，课程号，成绩</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"> <span class="title">SELECT</span> <span class="title">DISTINCT</span>  <span class="title">s1</span>.<span class="title">course_id</span>,<span class="title">s2</span>.<span class="title">course_id</span>,<span class="title">s1</span>.<span class="title">num</span>,<span class="title">s2</span>.<span class="title">num</span> <span class="title">FROM</span> <span class="title">score</span> <span class="title">AS</span> <span class="title">s1</span>, <span class="title">score</span> <span class="title">AS</span> <span class="title">s2</span> <span class="title">WHERE</span> <span class="title">s1</span>.<span class="title">num</span> = <span class="title">s2</span>.<span class="title">num</span> <span class="title">AND</span> <span class="title">s1</span>.<span class="title">course_id</span> &lt;&gt; <span class="title">s2</span>.<span class="title">course_id</span>;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">22、查询没学过“叶平”老师课程的学生姓名以及选修的课程名称；</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">    <span class="title">select</span> <span class="title">student_id</span>,<span class="title">student</span>.<span class="title">sname</span> <span class="title">from</span> <span class="title">score</span></span></span><br><span class="line"><span class="class">    <span class="title">left</span> <span class="title">join</span> <span class="title">student</span> <span class="title">on</span> <span class="title">score</span>.<span class="title">student_id</span> = <span class="title">student</span>.<span class="title">sid</span></span></span><br><span class="line"><span class="class">    <span class="title">where</span> <span class="title">score</span>.<span class="title">course_id</span> <span class="title">not</span> <span class="title">in</span> (<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="class">        select cid <span class="keyword">from</span> course left join teacher on course.teacher_id = teacher.tid where tname = <span class="string">&#x27;李华老师&#x27;</span></span></span></span><br><span class="line"><span class="params"><span class="class">    </span>)</span></span><br><span class="line"><span class="class">    <span class="title">group</span> <span class="title">by</span> <span class="title">student_id</span>;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">23、查询所有选修了学号为1的同学选修过的一门或者多门课程的同学学号和姓名；</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">24、任课最多的老师中学生单科成绩最高的学生姓名</span></span><br><span class="line"><span class="class"></span></span><br></pre></td></tr></table></figure>


    </div>

    
    
    
	  
	  
		   <div>
			 <div>
    
        <div style="text-align:center;color: #ccc;font-size:20px;">-------------End-------------</div>
    
</div>
		   </div>
	   

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Mysql/" rel="tag"># Mysql</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item"></div>
      <div class="post-nav-item">
    <a href="/2020/08/23/python/" rel="next" title="python">
      python <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#MySQL"><span class="nav-number">1.</span> <span class="nav-text">MySQL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9D%E5%A7%8Bsql"><span class="nav-number">1.0.1.</span> <span class="nav-text">初始sql</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%92%88%E5%AF%B9%E5%BA%93%E7%9A%84%E4%BF%AE%E5%88%A0%E6%94%B9%E6%9F%A5-%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="nav-number">1.0.2.</span> <span class="nav-text">针对库的修删改查(文件夹)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%92%88%E5%AF%B9%E8%A1%A8%E7%9A%84%E4%BF%AE%E5%88%A0%E6%94%B9%E6%9F%A5%EF%BC%88%E6%96%87%E4%BB%B6%EF%BC%89"><span class="nav-number">1.0.3.</span> <span class="nav-text">针对表的修删改查（文件）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%92%88%E5%AF%B9%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BF%AE%E5%88%A0%E6%94%B9%E6%9F%A5"><span class="nav-number">1.0.4.</span> <span class="nav-text">针对数据的修删改查</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mysql%E4%B8%BB%E8%A6%81%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="nav-number">1.0.5.</span> <span class="nav-text">Mysql主要存储引擎</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8%E7%9A%84%E5%AE%8C%E6%95%B4%E8%AF%AD%E6%B3%95"><span class="nav-number">1.0.6.</span> <span class="nav-text">创建表的完整语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8"><span class="nav-number">1.0.7.</span> <span class="nav-text">修改表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B"><span class="nav-number">1.0.8.</span> <span class="nav-text">示例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">2.</span> <span class="nav-text">数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B%E4%B9%8B%E6%95%B4%E5%9E%8B"><span class="nav-number">2.0.1.</span> <span class="nav-text">表字段类型之整型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B%E4%B9%8B%E6%97%A5%E6%9C%9F"><span class="nav-number">2.0.2.</span> <span class="nav-text">表字段类型之日期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B%E4%B9%8B%E5%AD%97%E7%AC%A6"><span class="nav-number">2.0.3.</span> <span class="nav-text">表字段类型之字符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B%E4%B9%8B%E6%9E%9A%E4%B8%BE%E4%B8%8E%E9%9B%86%E5%90%88"><span class="nav-number">2.0.4.</span> <span class="nav-text">表字段类型之枚举与集合</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E4%B9%8B%E9%97%B4%E7%9A%84%E4%B8%89%E7%A7%8D%E5%85%B3%E7%B3%BB"><span class="nav-number">2.0.5.</span> <span class="nav-text">表之间的三种关系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="nav-number">2.0.6.</span> <span class="nav-text">单表查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="nav-number">2.0.7.</span> <span class="nav-text">多表查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86"><span class="nav-number">2.0.8.</span> <span class="nav-text">权限管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SQL%E8%AF%AD%E5%8F%A5%E6%9F%A5%E8%AF%A2%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="nav-number">2.0.9.</span> <span class="nav-text">SQL语句查询执行顺序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SELECT%E8%AF%AD%E5%8F%A5%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%AE%9A%E4%B9%89%E9%A1%BA%E5%BA%8F"><span class="nav-number">2.0.9.1.</span> <span class="nav-text">SELECT语句关键字的定义顺序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SELECT%E8%AF%AD%E5%8F%A5%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="nav-number">2.0.9.2.</span> <span class="nav-text">SELECT语句关键字的执行顺序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%86%E5%A4%87%E8%A1%A8%E5%92%8C%E6%95%B0%E6%8D%AE"><span class="nav-number">2.0.9.3.</span> <span class="nav-text">准备表和数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2"><span class="nav-number">2.0.9.4.</span> <span class="nav-text">查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="nav-number">2.0.9.5.</span> <span class="nav-text">单表查询的语法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E6%89%A7%E8%A1%8C%E4%BC%98%E5%85%88%E7%BA%A7"><span class="nav-number">2.0.9.6.</span> <span class="nav-text">关键字的执行优先级</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2%E7%BB%83%E4%B9%A0"><span class="nav-number">2.0.9.7.</span> <span class="nav-text">单表查询练习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2group-by"><span class="nav-number">2.0.9.8.</span> <span class="nav-text">分组查询group_by</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="nav-number">2.0.9.9.</span> <span class="nav-text">聚合函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#having%E8%BF%87%E6%BB%A4"><span class="nav-number">2.0.9.10.</span> <span class="nav-text">having过滤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E6%8E%92%E5%BA%8F-ORDER-BY"><span class="nav-number">2.0.9.11.</span> <span class="nav-text">查询排序:ORDER BY</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%99%90%E5%88%B6%E6%9F%A5%E8%AF%A2%E7%9A%84%E8%AE%B0%E5%BD%95%E6%95%B0-LIMIT"><span class="nav-number">2.0.9.12.</span> <span class="nav-text">限制查询的记录数:LIMIT</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%9F%A5%E8%AF%A2"><span class="nav-number">2.0.9.13.</span> <span class="nav-text">使用正则表达式查询</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD"><span class="nav-number">3.</span> <span class="nav-text">数据备份</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD"><span class="nav-number">3.0.1.</span> <span class="nav-text">MySQL数据备份</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8mysqldump%E5%AE%9E%E7%8E%B0%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD"><span class="nav-number">3.0.1.1.</span> <span class="nav-text">使用mysqldump实现逻辑备份</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%81%A2%E5%A4%8D%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD"><span class="nav-number">3.0.1.2.</span> <span class="nav-text">恢复逻辑备份</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%87%E4%BB%BD-%E6%81%A2%E5%A4%8D%E6%A1%88%E4%BE%8B"><span class="nav-number">3.0.1.3.</span> <span class="nav-text">备份&#x2F;恢复案例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E5%8C%96%E5%A4%87%E4%BB%BD"><span class="nav-number">3.0.1.4.</span> <span class="nav-text">实现自动化备份</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A8%E7%9A%84%E5%AF%BC%E5%87%BA%E5%92%8C%E5%AF%BC%E5%85%A5"><span class="nav-number">3.0.1.5.</span> <span class="nav-text">表的导出和导入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB"><span class="nav-number">3.0.1.6.</span> <span class="nav-text">数据库迁移</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sql%E6%B3%A8%E5%85%A5%E8%A7%A3%E5%86%B3"><span class="nav-number">3.0.1.7.</span> <span class="nav-text">sql注入解决</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A2%9E%E3%80%81%E5%88%A0%E3%80%81%E6%94%B9%EF%BC%9Aconn-commit"><span class="nav-number">3.0.1.8.</span> <span class="nav-text">增、删、改：conn.commit()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%EF%BC%9Afetchone%EF%BC%8Cfetchmany%EF%BC%8Cfetchall"><span class="nav-number">3.0.1.9.</span> <span class="nav-text">查：fetchone，fetchmany，fetchall</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%8F%92%E5%85%A5%E7%9A%84%E6%9C%80%E5%90%8E%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE%E7%9A%84%E8%87%AA%E5%A2%9EID"><span class="nav-number">3.0.1.10.</span> <span class="nav-text">获取插入的最后一条数据的自增ID</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL%E7%BB%83%E4%B9%A0"><span class="nav-number">4.</span> <span class="nav-text">SQL练习</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Admin"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Admin</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">20</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2021-07 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Admin</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>







    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span id="busuanzi_container_site_pv">总访问量<span id="busuanzi_value_site_pv"></span>次</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">总访客数<span id="busuanzi_value_site_uv"></span>人</span>
    <span class="post-meta-divider">|</span>
<!-- 不蒜子计数初始值纠正 -->
<script>
$(document).ready(function() {

    var int = setInterval(fixCount, 50);  // 50ms周期检测函数
    var countOffset = 20000;  // 初始化首次数据

    function fixCount() {            
       if (document.getElementById("busuanzi_container_site_pv").style.display != "none")
        {
            $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + countOffset); 
            clearInterval(int);
        }                  
        if ($("#busuanzi_container_site_pv").css("display") != "none")
        {
            $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + countOffset); // 加上初始数据 
            clearInterval(int); // 停止检测
        }  
    }
       	
});
</script> 


<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共151.4k字</span>
</div>
        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

</body>
</html>
